# Часть I: Введение

## 1. Обзор

DAP SDK Test Framework - это production-ready инфраструктура тестирования для экосистемы блокчейна Cellframe. Она предоставляет комплексные инструменты для тестирования асинхронных операций, мокирования внешних зависимостей и обеспечения надёжного выполнения тестов на разных платформах.

### 1.1 Что такое DAP SDK Test Framework?

Полное решение для тестирования, включающее:

- **Async Testing Framework** - Инструменты для тестирования асинхронных операций с таймаутами
- **Mock Framework V4** - Мокирование функций без модификации кода
- **Auto-Wrapper System** - Автоматическая конфигурация линкера
- **Self-Tests** - 21 тест, валидирующий надёжность фреймворка

### 1.2 Зачем использовать этот фреймворк?

**Проблема:** Тестирование асинхронного кода сложно
- Операции завершаются в непредсказуемое время
- Сетевые задержки варьируются
- Тесты могут зависать бесконечно
- Внешние зависимости усложняют тестирование

**Решение:** Этот фреймворк предоставляет
- ✅ Защиту от зависаний (глобальный + для каждой операции)
- ✅ Эффективное ожидание (polling + condition variables)
- ✅ Изоляцию зависимостей (мокирование)
- ✅ Реалистичную симуляцию (задержки, ошибки)
- ✅ Потокобезопасные операции
- ✅ Кроссплатформенность

### 1.3 Ключевые возможности

| Возможность | Описание | Польза |
|-------------|----------|--------|
| Global Timeout | alarm + siglongjmp | Предотвращает зависание CI/CD |
| Condition Polling | Конфигурируемые интервалы | Эффективное ожидание |
| pthread Helpers | Обёртки для condition variables | Потокобезопасная координация |
| Mock Framework | На основе линкера (`--wrap`) | Нулевой техдолг |
| Задержки | Fixed, Range, Variance | Реалистичная симуляция |
| Callbacks | Inline + Runtime | Динамическое поведение моков |
| Auto-Wrapper | Bash/PowerShell скрипты | Автоматическая настройка |
| Self-Tests | 21 комплексный тест | Проверенная надёжность |

### 1.4 Быстрое сравнение

**Традиционный подход:**
```c
// ❌ Плохо: занятое ожидание, нет таймаута, трата CPU
while (!done) {
    usleep(10000);  // 10ms сон
}
```

**С DAP Test Framework:**
```c
// ✅ Хорошо: эффективно, защита таймаутом, автоматическое логирование
DAP_TEST_WAIT_UNTIL(done == true, 5000, "Should complete");
```

### 1.5 Целевая аудитория

- Разработчики DAP SDK
- Контрибьюторы Cellframe SDK
- Разработчики VPN Client
- Все, кто тестирует асинхронный C код в экосистеме Cellframe

### 1.6 Предварительные требования

**Необходимые знания:**
- Программирование на C
- Базовое понимание асинхронных операций
- Основы CMake
- Концепции pthread (для продвинутых возможностей)

**Необходимое ПО:**
- GCC 7+ или Clang 10+ (или MinGW на Windows)
- CMake 3.10+
- Библиотека pthread
- Linux, macOS, или Windows (частичная поддержка)

\newpage

