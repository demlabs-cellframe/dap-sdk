## 6. Решение проблем

### Проблема: Тест зависает
**Симптом:** Тест выполняется бесконечно  
**Решение:** Добавьте глобальный таймаут
```c
dap_test_set_global_timeout(&timeout, 30, "Tests");
```

### Проблема: Высокая загрузка CPU
**Симптом:** 100% CPU во время теста  
**Решение:** Увеличьте интервал polling или используйте pthread helpers
```c
cfg.poll_interval_ms = 500;  // Менее частый polling
```

### Проблема: Мок не вызывается
**Симптом:** Выполняется реальная функция  
**Решение:** Проверьте флаги линкера
```bash
make VERBOSE=1 | grep -- "--wrap"
```

### Проблема: Неправильное возвращаемое значение
**Симптом:** Мок возвращает неожиданное значение  
**Решение:** Используйте правильное поле union
```c
.return_value.i = 42      // int
.return_value.l = 0xDEAD  // указатель
.return_value.ptr = ptr   // void*
```

### Проблема: Нестабильные тесты
**Симптом:** Иногда проходят, иногда падают  
**Решение:** Увеличьте таймаут, добавьте допуск
```c
cfg.timeout_ms = 60000;  // 60 сек для сети
assert(elapsed >= 90 && elapsed <= 150);  // ±50мс допуск
```

\newpage
