# DAP SDK Crypto Module - –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –º–æ–¥—É–ª—å

## ‚ö†Ô∏è **–í–ê–ñ–ù–û–ï –ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–ï –û –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò**

# üö® **–ö–í–ê–ù–¢–û–í–ê–Ø –ù–ï–ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨ –ö–õ–ê–°–°–ò–ß–ï–°–ö–ò–• –ê–õ–ì–û–†–ò–¢–ú–û–í**

**DAP SDK –≤–∫–ª—é—á–∞–µ—Ç –∫–∞–∫ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–æ—Å—Ç-–∫–≤–∞–Ω—Ç–æ–≤—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã, —Ç–∞–∫ –∏ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ –º–µ—Ç–æ–¥—ã –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏. –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –ù–ï –û–ë–ï–°–ü–ï–ß–ò–í–ê–Æ–¢ –ó–ê–©–ò–¢–£ –û–¢ –ê–¢–ê–ö –ö–í–ê–ù–¢–û–í–´–• –ö–û–ú–ü–¨–Æ–¢–ï–†–û–í.**

### **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è:**
- ‚úÖ **–ü–æ—Å—Ç-–∫–≤–∞–Ω—Ç–æ–≤—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã**: Falcon, Dilithium, Kyber - –ë–ï–ó–û–ü–ê–°–ù–´ –æ—Ç –∫–≤–∞–Ω—Ç–æ–≤—ã—Ö –∞—Ç–∞–∫
- ‚ùå **–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã**: ECDSA, –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Ä–µ–∂–∏–º—ã AES - –£–Ø–ó–í–ò–ú–´ –∫ –∫–≤–∞–Ω—Ç–æ–≤—ã–º –∞—Ç–∞–∫–∞–º
- ‚ùå **–ù–ï –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø** –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –≤ –Ω–æ–≤—ã—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö
- ‚úÖ **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Å–∏—Å—Ç–µ–º

### **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
üü¢ **–î–ª—è –Ω–æ–≤—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:**
- **Falcon** –∏–ª–∏ **Dilithium** –¥–ª—è —Ü–∏—Ñ—Ä–æ–≤—ã—Ö –ø–æ–¥–ø–∏—Å–µ–π
- **Kyber** –¥–ª—è –æ–±–º–µ–Ω–∞ –∫–ª—é—á–∞–º–∏
- **AES-256** –¥–ª—è —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–≥–æ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è

üî¥ **–ò–∑–±–µ–≥–∞–π—Ç–µ –≤ –Ω–æ–≤—ã—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö:**
- **ECDSA** (—É—è–∑–≤–∏–º –∫ –∞–ª–≥–æ—Ä–∏—Ç–º—É –®–æ—Ä–∞)
- **RSA** (—É—è–∑–≤–∏–º –∫ –∞–ª–≥–æ—Ä–∏—Ç–º—É –®–æ—Ä–∞)
- –ö–æ—Ä–æ—Ç–∫–∏–µ –∫–ª—é—á–∏ AES (128-bit —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —É—è–∑–≤–∏–º—ã–º)

---

## –û–±–∑–æ—Ä

–ú–æ–¥—É–ª—å `dap-sdk/crypto` –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –Ω–∞–∏–±–æ–ª–µ–µ –º–æ—â–Ω—ã–π –∏ –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –º–æ–¥—É–ª—å –≤ DAP SDK. –û–Ω –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ–ª–Ω—É—é –ø–æ–¥–¥–µ—Ä–∂–∫—É –∫–∞–∫ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏—Ö, —Ç–∞–∫ –∏ –ø–æ—Å—Ç-–∫–≤–∞–Ω—Ç–æ–≤—ã—Ö –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –≤—ã—Å–æ–∫—É—é –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π.

## –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### üõ°Ô∏è **–ü–æ–ª–Ω–∞—è –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞**
- **–°–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ**: [AES](crypto/dap_enc_iaes.md), Blowfish, GOST, Salsa2012, SEED
- **–ê—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ**: [Kyber](crypto/dap_enc_kyber.md), NewHope, MSR-LN
- **–¶–∏—Ñ—Ä–æ–≤—ã–µ –ø–æ–¥–ø–∏—Å–∏**: [ECDSA](crypto/dap_enc_ecdsa.md), [Falcon](crypto/dap_enc_falcon.md), [Dilithium](crypto/dap_enc_dilithium.md), [Sphincs+](crypto/dap_enc_sphincsplus.md), Bliss, Picnic, Tesla
- **–ú–Ω–æ–≥–æ—Å—Ç–æ—Ä–æ–Ω–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∏**: Multisign, MSR-LN
- **Ring signatures**: RingCT20, Shipovnik
- **–•—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**: SHA-3/Keccak, Blake2, Fusion
- **–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã**: [X.509 —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–µ](crypto/dap_cert.md) —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
- **–ö–ª—é—á–∏ –∏ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã**: UUID, GUID
- **[–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª—é—á–∞–º–∏](crypto/dap_enc_key.md)**: –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π API –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –∫–ª—é—á–µ–π

### üîê **–ü–æ—Å—Ç-–∫–≤–∞–Ω—Ç–æ–≤–∞—è –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—è**
- **[Kyber](crypto/dap_enc_kyber.md)** - KEM (Key Encapsulation Mechanism) –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ—à–µ—Ç–æ–∫
- **[Falcon](crypto/dap_enc_falcon.md)** - –ü–æ–¥–ø–∏—Å–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ—à–µ—Ç–æ–∫ (NIST finalist)
- **[Dilithium](crypto/dap_enc_dilithium.md)** - –ü–æ–¥–ø–∏—Å–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ—à–µ—Ç–æ–∫ (NIST finalist)
- **[Sphincs+](crypto/dap_enc_sphincsplus.md)** - –•—ç—à-–ø–æ–¥–ø–∏—Å–∏ (NIST finalist)
- **NewHope** - –ü—Ä–æ—Ç–æ–∫–æ–ª –æ–±–º–µ–Ω–∞ –∫–ª—é—á–∞–º–∏
- **Picnic** - ZKP-–ø–æ–¥–ø–∏—Å–∏ –Ω–∞ —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã—Ö –ø—Ä–∏–º–∏—Ç–∏–≤–∞—Ö

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª—è

```
dap-sdk/crypto/
‚îú‚îÄ‚îÄ include/                 # –ó–∞–≥–æ–ª–æ–≤–æ—á–Ω—ã–µ —Ñ–∞–π–ª—ã
‚îÇ   ‚îú‚îÄ‚îÄ dap_enc.h           # –û—Å–Ω–æ–≤–Ω–æ–π API —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ dap_enc_key.h       # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª—é—á–∞–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ dap_hash.h          # –•—ç—à-—Ñ—É–Ω–∫—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ dap_sign.h          # –¶–∏—Ñ—Ä–æ–≤—ã–µ –ø–æ–¥–ø–∏—Å–∏
‚îÇ   ‚îú‚îÄ‚îÄ dap_cert.h          # –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ [–∞–ª–≥–æ—Ä–∏—Ç–º—ã]         # –°–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã
‚îú‚îÄ‚îÄ src/                    # –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥
‚îÇ   ‚îú‚îÄ‚îÄ [–∞–ª–≥–æ—Ä–∏—Ç–º—ã]/        # –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ XKCP/              # Keccak/SHA-3 –±–∏–±–ª–∏–æ—Ç–µ–∫–∞
‚îî‚îÄ‚îÄ test/                   # –¢–µ—Å—Ç—ã
```

## –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 1. **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª—é—á–∞–º–∏ (dap_enc_key.h/c)**

#### –°—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö

```c
typedef struct dap_enc_key {
    union {
        size_t priv_key_data_size;
        size_t shared_key_size;
    };
    union {
        void *priv_key_data;    // –ü—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á –∏–ª–∏ –æ–±—â–∏–π —Å–µ–∫—Ä–µ—Ç
        byte_t *shared_key;
    };

    size_t pub_key_data_size;
    void *pub_key_data;         // –ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á

    time_t last_used_timestamp;
    dap_enc_key_type_t type;    // –¢–∏–ø –∞–ª–≥–æ—Ä–∏—Ç–º–∞

    // Callbacks –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π
    dap_enc_callback_dataop_t enc;
    dap_enc_callback_dataop_t dec;
    dap_enc_callback_sign_op_t sign_get;
    dap_enc_callback_sign_op_t sign_verify;
    // ... –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ callbacks
} dap_enc_key_t;
```

#### –¢–∏–ø—ã –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤

```c
typedef enum dap_enc_key_type {
    // –°–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã
    DAP_ENC_KEY_TYPE_IAES = 0,           // AES
    DAP_ENC_KEY_TYPE_OAES = 1,           // OAES (Monero)
    DAP_ENC_KEY_TYPE_BF_CBC = 2,         // Blowfish CBC
    DAP_ENC_KEY_TYPE_SALSA2012 = 6,      // Salsa2012
    DAP_ENC_KEY_TYPE_SEED_OFB = 7,       // SEED OFB

    // –ü–æ—Å—Ç-–∫–≤–∞–Ω—Ç–æ–≤—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã
    DAP_ENC_KEY_TYPE_MLWE_KYBER = 17,    // Kyber KEM
    DAP_ENC_KEY_TYPE_SIG_FALCON = 24,    // Falcon signatures
    DAP_ENC_KEY_TYPE_SIG_DILITHIUM = 21, // Dilithium signatures
    DAP_ENC_KEY_TYPE_SIG_SPHINCSPLUS = 25, // Sphincs+ signatures

    // –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ –ø–æ–¥–ø–∏—Å–∏
    DAP_ENC_KEY_TYPE_SIG_ECDSA = 26,     // ECDSA
    DAP_ENC_KEY_TYPE_SIG_BLISS = 19,     // BLISS

    // –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ
    DAP_ENC_KEY_TYPE_SIG_RINGCT20 = 22,  // Ring signatures
    DAP_ENC_KEY_TYPE_SIG_SHIPOVNIK = 27, // Shipovnik signatures
    DAP_ENC_KEY_TYPE_SIG_MULTI_CHAINED = 100, // Multisignatures

    // ... –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–∏–ø—ã
} dap_enc_key_type_t;
```

## API Reference

### –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ

#### dap_enc_init()
```c
int dap_enc_init(void);
```
**–û–ø–∏—Å–∞–Ω–∏–µ**: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –º–æ–¥—É–ª—å.

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç**:
- `0` - —É—Å–ø–µ—Ö
- `-1` - –æ—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏

#### dap_enc_deinit()
```c
void dap_enc_deinit(void);
```
**–û–ø–∏—Å–∞–Ω–∏–µ**: –ó–∞–≤–µ—Ä—à–∞–µ—Ç —Ä–∞–±–æ—Ç—É –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–≥–æ –º–æ–¥—É–ª—è –∏ –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç —Ä–µ—Å—É—Ä—Å—ã.

### –†–∞–±–æ—Ç–∞ —Å –∫–ª—é—á–∞–º–∏

#### dap_enc_key_new()
```c
dap_enc_key_t *dap_enc_key_new(dap_enc_key_type_t a_key_type);
```
**–û–ø–∏—Å–∞–Ω–∏–µ**: –°–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π –æ–±—ä–µ–∫—Ç –∫–ª—é—á–∞ –∑–∞–¥–∞–Ω–Ω–æ–≥–æ —Ç–∏–ø–∞.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
- `a_key_type` - —Ç–∏–ø –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç**: –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Å–æ–∑–¥–∞–Ω–Ω—ã–π –∫–ª—é—á –∏–ª–∏ `NULL` –ø—Ä–∏ –æ—à–∏–±–∫–µ

#### dap_enc_key_delete()
```c
void dap_enc_key_delete(dap_enc_key_t *a_key);
```
**–û–ø–∏—Å–∞–Ω–∏–µ**: –£–¥–∞–ª—è–µ—Ç –∫–ª—é—á –∏ –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç –≤—Å–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã.

### –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –∏ –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ

#### dap_enc_code()
```c
size_t dap_enc_code(dap_enc_key_t *a_key,
                    const void *a_buf_in, size_t a_buf_in_size,
                    void *a_buf_out, size_t a_buf_out_size_max,
                    dap_enc_data_type_t a_data_type_out);
```
**–û–ø–∏—Å–∞–Ω–∏–µ**: –®–∏—Ñ—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∑–∞–¥–∞–Ω–Ω–æ–≥–æ –∫–ª—é—á–∞.

#### dap_enc_decode()
```c
size_t dap_enc_decode(dap_enc_key_t *a_key,
                      const void *a_buf_in, size_t a_buf_in_size,
                      void *a_buf_out, size_t a_buf_out_size_max,
                      dap_enc_data_type_t a_data_type_in);
```
**–û–ø–∏—Å–∞–Ω–∏–µ**: –î–µ—à–∏—Ñ—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∑–∞–¥–∞–Ω–Ω–æ–≥–æ –∫–ª—é—á–∞.

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –°–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ AES

```c
#include "dap_enc.h"
#include "dap_enc_key.h"

int aes_example() {
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–≥–æ –º–æ–¥—É–ª—è
    if (dap_enc_init() != 0) {
        fprintf(stderr, "Failed to initialize crypto module\n");
        return -1;
    }

    if (dap_enc_key_init() != 0) {
        fprintf(stderr, "Failed to initialize key module\n");
        dap_enc_deinit();
        return -1;
    }

    // –°–æ–∑–¥–∞–Ω–∏–µ AES –∫–ª—é—á–∞ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
    const char *seed = "my_secret_seed";
    dap_enc_key_t *key = dap_enc_key_new_generate(DAP_ENC_KEY_TYPE_IAES,
                                                  NULL, 0,                    // kex_buf, kex_size
                                                  (const void*)seed, strlen(seed), // seed, seed_size
                                                  256);                       // key_size

    if (!key) {
        fprintf(stderr, "Failed to generate AES key\n");
        dap_enc_key_deinit();
        dap_enc_deinit();
        return -1;
    }

    // –î–∞–Ω–Ω—ã–µ –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
    const char *plaintext = "Hello, World!";
    size_t plaintext_len = strlen(plaintext);

    // –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –±—É—Ñ–µ—Ä–∞ –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
    size_t encrypted_size = dap_enc_code_out_size(key, plaintext_len, DAP_ENC_DATA_TYPE_RAW);
    if (encrypted_size == 0) {
        fprintf(stderr, "Failed to calculate encrypted size\n");
        dap_enc_key_delete(key);
        dap_enc_key_deinit();
        dap_enc_deinit();
        return -1;
    }

    uint8_t *encrypted = malloc(encrypted_size);
    if (!encrypted) {
        fprintf(stderr, "Memory allocation failed\n");
        dap_enc_key_delete(key);
        dap_enc_key_deinit();
        dap_enc_deinit();
        return -1;
    }

    // –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
    size_t actual_encrypted_size = dap_enc_code(key,
                                               (const void*)plaintext, plaintext_len,
                                               encrypted, encrypted_size,
                                               DAP_ENC_DATA_TYPE_RAW);

    if (actual_encrypted_size == 0) {
        fprintf(stderr, "Encryption failed\n");
        free(encrypted);
        dap_enc_key_delete(key);
        dap_enc_key_deinit();
        dap_enc_deinit();
        return -1;
    }

    // –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –±—É—Ñ–µ—Ä–∞ –¥–ª—è –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
    size_t decrypted_size = dap_enc_decode_out_size(key, actual_encrypted_size, DAP_ENC_DATA_TYPE_RAW);
    if (decrypted_size == 0) {
        fprintf(stderr, "Failed to calculate decrypted size\n");
        free(encrypted);
        dap_enc_key_delete(key);
        dap_enc_key_deinit();
        dap_enc_deinit();
        return -1;
    }

    uint8_t *decrypted = malloc(decrypted_size);
    if (!decrypted) {
        fprintf(stderr, "Memory allocation failed\n");
        free(encrypted);
        dap_enc_key_delete(key);
        dap_enc_key_deinit();
        dap_enc_deinit();
        return -1;
    }

    // –î–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
    size_t actual_decrypted_size = dap_enc_decode(key,
                                                 encrypted, actual_encrypted_size,
                                                 decrypted, decrypted_size,
                                                 DAP_ENC_DATA_TYPE_RAW);

    if (actual_decrypted_size == 0) {
        fprintf(stderr, "Decryption failed\n");
        free(encrypted);
        free(decrypted);
        dap_enc_key_delete(key);
        dap_enc_key_deinit();
        dap_enc_deinit();
        return -1;
    }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏
    if (actual_decrypted_size == plaintext_len &&
        memcmp(decrypted, plaintext, plaintext_len) == 0) {
        printf("AES encryption/decryption successful!\n");
    } else {
        fprintf(stderr, "Decryption verification failed\n");
        free(encrypted);
        free(decrypted);
        dap_enc_key_delete(key);
        dap_enc_key_deinit();
        dap_enc_deinit();
        return -1;
    }

    // –û—á–∏—Å—Ç–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤
    free(encrypted);
    free(decrypted);
    dap_enc_key_delete(key);
    dap_enc_key_deinit();
    dap_enc_deinit();

    return 0;
}
```

### –ü—Ä–∏–º–µ—Ä 2: –ü–æ—Å—Ç-–∫–≤–∞–Ω—Ç–æ–≤–∞—è –ø–æ–¥–ø–∏—Å—å —Å Dilithium

```c
#include "dap_enc.h"
#include "dap_enc_key.h"

int dilithium_sign_example() {
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    if (dap_enc_init() != 0) return -1;

    // –°–æ–∑–¥–∞–Ω–∏–µ Dilithium –∫–ª—é—á–∞
    dap_enc_key_t *key = dap_enc_key_new_generate(DAP_ENC_KEY_TYPE_SIG_DILITHIUM,
                                                  NULL, 0,
                                                  "dilithium_seed", 14,
                                                  0);

    // –î–∞–Ω–Ω—ã–µ –¥–ª—è –ø–æ–¥–ø–∏—Å–∏
    const char *message = "Post-quantum signature test";
    size_t message_len = strlen(message);

    // –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∏
    size_t sig_size = dap_enc_calc_signature_unserialized_size(key);
    uint8_t *signature = malloc(sig_size);

    int sign_result = key->sign_get(key, message, message_len, signature, sig_size);

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏
    int verify_result = key->sign_verify(key, message, message_len, signature, sig_size);

    // –û—á–∏—Å—Ç–∫–∞
    free(signature);
    dap_enc_key_delete(key);
    dap_enc_deinit();

    return verify_result == 0 ? 0 : -1;
}
```

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –ë–µ–Ω—á–º–∞—Ä–∫–∏ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

| –ê–ª–≥–æ—Ä–∏—Ç–º | –û–ø–µ—Ä–∞—Ü–∏—è | –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
|----------|----------|-------------------|------------|
| **AES-256** | –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ | ~500 MB/s | Intel Core i7 |
| **Kyber** | KEM –≥–µ–Ω–µ—Ä–∞—Ü–∏—è | ~10 Œºs | NIST Level 1 |
| **Falcon** | –ü–æ–¥–ø–∏—Å—å | ~100 Œºs | NIST Level 1 |
| **Dilithium** | –ü–æ–¥–ø–∏—Å—å | ~50 Œºs | NIST Level 2 |
| **ECDSA** | –ü–æ–¥–ø–∏—Å—å | ~20 Œºs | secp256r1 |

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –£—Ä–æ–≤–Ω–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

#### –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã
- **AES-256**: 128-bit –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- **ECDSA**: 128-bit –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (—É—è–∑–≤–∏–º –∫ –∫–≤–∞–Ω—Ç–æ–≤—ã–º –∞—Ç–∞–∫–∞–º)

#### –ü–æ—Å—Ç-–∫–≤–∞–Ω—Ç–æ–≤—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã
- **Kyber**: 128/192/256-bit –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø—Ä–æ—Ç–∏–≤ –∫–≤–∞–Ω—Ç–æ–≤—ã—Ö –∞—Ç–∞–∫
- **Falcon**: 128/192/256-bit –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- **Dilithium**: 128/192/256-bit –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

#### –î–ª—è –Ω–æ–≤—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):
```c
// –ü–æ—Å—Ç-–∫–≤–∞–Ω—Ç–æ–≤–∞—è –ø–æ–¥–ø–∏—Å—å
dap_enc_key_t *sign_key = dap_enc_key_new_generate(DAP_ENC_KEY_TYPE_SIG_DILITHIUM, ...);

// –ü–æ—Å—Ç-–∫–≤–∞–Ω—Ç–æ–≤—ã–π KEM
dap_enc_key_t *kem_key = dap_enc_key_new_generate(DAP_ENC_KEY_TYPE_MLWE_KYBER, ...);

// –°–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
dap_enc_key_t *enc_key = dap_enc_key_new_generate(DAP_ENC_KEY_TYPE_IAES, ...);
```

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ú–æ–¥—É–ª—å `dap-sdk/crypto` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ–ª–Ω—É—é –∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—É—é –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫—É—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É:

### –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:
- **–ë—É–¥—É—â–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–æ—Å—Ç-–∫–≤–∞–Ω—Ç–æ–≤—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤
- **–í—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- **–ü—Ä–æ—Å—Ç–æ—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**: –ï–¥–∏–Ω—ã–π API –¥–ª—è –≤—Å–µ—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤
- **–ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å**: –õ–µ–≥–∫–æ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –∏ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
1. **–î–ª—è –Ω–æ–≤—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ—Å—Ç-–∫–≤–∞–Ω—Ç–æ–≤—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã (Kyber, Falcon, Dilithium)
2. **–î–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è**: AES-256 –∏–ª–∏ –ø–æ—Å—Ç-–∫–≤–∞–Ω—Ç–æ–≤—ã–µ –∞–Ω–∞–ª–æ–≥–∏
3. **–î–ª—è –ø–æ–¥–ø–∏—Å–µ–π**: Dilithium –∏–ª–∏ Falcon (NIST finalists)

–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ —Å–º–æ—Ç—Ä–∏—Ç–µ:
- `dap_enc.h` - –æ—Å–Ω–æ–≤–Ω–æ–π API —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
- `dap_enc_key.h` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª—é—á–∞–º–∏
- `dap_sign.h` - —Ü–∏—Ñ—Ä–æ–≤—ã–µ –ø–æ–¥–ø–∏—Å–∏
- `dap_hash.h` - —Ö—ç—à-—Ñ—É–Ω–∫—Ü–∏–∏
- –ü—Ä–∏–º–µ—Ä—ã –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `examples/crypto/`
- –¢–µ—Å—Ç—ã –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `test/crypto/`