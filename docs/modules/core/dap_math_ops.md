# DAP Mathematical Operations (–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏)

## –û–±–∑–æ—Ä

–ú–æ–¥—É–ª—å `dap_math_ops` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –≤—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã–µ –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–æ–ª—å—à–∏–º–∏ —Ü–µ–ª—ã–º–∏ —á–∏—Å–ª–∞–º–∏ (128-bit, 256-bit, 512-bit) –≤ DAP SDK. –≠—Ç–æ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π –º–æ–¥—É–ª—å –¥–ª—è –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π, –±–ª–æ–∫—á–µ–π–Ω –æ–ø–µ—Ä–∞—Ü–∏–π –∏ —Ä–∞–±–æ—Ç—ã —Å –±–æ–ª—å—à–∏–º–∏ —á–∏—Å–ª–∞–º–∏ –≤ —Å–∏—Å—Ç–µ–º–µ DATOSHI.

## –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

DAP SDK —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –æ—á–µ–Ω—å –±–æ–ª—å—à–∏–º–∏ —á–∏—Å–ª–∞–º–∏ –¥–ª—è:
- **–ö—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π**: –ë–∞–ª–∞–Ω—Å—ã, —Å—É–º–º—ã —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
- **–ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π**: –ú–æ–¥—É–ª—è—Ä–Ω–∞—è –∞—Ä–∏—Ñ–º–µ—Ç–∏–∫–∞, —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- **–ë–ª–æ–∫—á–µ–π–Ω –æ–ø–µ—Ä–∞—Ü–∏–π**: –†–∞–±–æ—Ç–∞ —Å –±–æ–ª—å—à–∏–º–∏ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞–º–∏, —Å—á–µ—Ç—á–∏–∫–∞–º–∏
- **–§–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö —Ä–∞—Å—á–µ—Ç–æ–≤**: –í—ã—Å–æ–∫–æ—Ç–æ—á–Ω–∞—è –∞—Ä–∏—Ñ–º–µ—Ç–∏–∫–∞ —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ç–æ—á–∫–æ–π

–ú–æ–¥—É–ª—å –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:
- **–ö—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω—É—é –ø–æ–¥–¥–µ—Ä–∂–∫—É**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
- **–í—ã—Å–æ–∫—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ inline —Ñ—É–Ω–∫—Ü–∏–∏
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è –∏ –¥–µ–ª–µ–Ω–∏—è –Ω–∞ –Ω–æ–ª—å
- **–ì–∏–±–∫–æ—Å—Ç—å**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ä–∞–∑–º–µ—Ä–æ–≤ —á–∏—Å–µ–ª

## –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### üßÆ **–ê—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏**
- –°–ª–æ–∂–µ–Ω–∏–µ –∏ –≤—ã—á–∏—Ç–∞–Ω–∏–µ (SUM, SUBTRACT)
- –£–º–Ω–æ–∂–µ–Ω–∏–µ –∏ –¥–µ–ª–µ–Ω–∏–µ (MULT, DIV)
- –ü–æ–±–∏—Ç–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (AND, OR, SHIFT)
- –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç/–¥–µ–∫—Ä–µ–º–µ–Ω—Ç (INCR, DECR)
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ (COMPARE)

### üî¢ **–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö**
- **uint128_t**: 128-–±–∏—Ç–Ω—ã–µ –±–µ–∑–∑–Ω–∞–∫–æ–≤—ã–µ —Ü–µ–ª—ã–µ
- **uint256_t**: 256-–±–∏—Ç–Ω—ã–µ –±–µ–∑–∑–Ω–∞–∫–æ–≤—ã–µ —Ü–µ–ª—ã–µ
- **uint512_t**: 512-–±–∏—Ç–Ω—ã–µ –±–µ–∑–∑–Ω–∞–∫–æ–≤—ã–µ —Ü–µ–ª—ã–µ

### üèóÔ∏è **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è**
- **GCC/Clang —Å __int128**: –ù–∞—Ç–∏–≤–Ω–∞—è –∞–ø–ø–∞—Ä–∞—Ç–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞
- **–î—Ä—É–≥–∏–µ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä—ã**: –ü—Ä–æ–≥—Ä–∞–º–º–Ω–∞—è —ç–º—É–ª—è—Ü–∏—è —á–µ—Ä–µ–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ**: –ú–∞–∫—Ä–æ—Å—ã –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞

### GCC/Clang —Å __int128
```c
#define DAP_GLOBAL_IS_INT128
typedef __int128 int128_t;
typedef unsigned __int128 uint128_t;
```
**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ù–∞—Ç–∏–≤–Ω–∞—è –∞–ø–ø–∞—Ä–∞—Ç–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –∫–æ–¥–∞

### –≠–º—É–ª—è—Ü–∏—è —á–µ—Ä–µ–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
```c
typedef union uint128_t {
    struct {
        uint64_t lo;
        uint64_t hi;
    } DAP_ALIGN_PACKED;
} uint128_t;
```
**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ü—Ä–æ–≥—Ä–∞–º–º–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π
- –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
- –ë–æ–ª–µ–µ –∫—Ä—É–ø–Ω—ã–π —Ä–∞–∑–º–µ—Ä –∫–æ–¥–∞

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö uint256_t

```c
typedef struct uint256_t {
    union {
        struct {
            uint128_t hi;    // –°—Ç–∞—Ä—à–∏–µ 128 –±–∏—Ç
            uint128_t lo;    // –ú–ª–∞–¥—à–∏–µ 128 –±–∏—Ç
        } DAP_ALIGN_PACKED;
        // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –¥–ª—è 64-–±–∏—Ç–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
    } DAP_ALIGN_PACKED;
} DAP_ALIGN_PACKED uint256_t;
```

## API –§—É–Ω–∫—Ü–∏–∏

### –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –∏ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

```c
// –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã
extern const uint128_t uint128_0, uint128_1, uint128_max;
extern const uint256_t uint256_0, uint256_1, uint256_max;
extern const uint512_t uint512_0;

// –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ç–∏–ø–æ–≤
static inline uint128_t GET_128_FROM_64(uint64_t n);
static inline uint128_t GET_128_FROM_64_64(uint64_t hi, uint64_t lo);
static inline uint256_t GET_256_FROM_64(uint64_t n);
static inline uint256_t GET_256_FROM_128(uint128_t n);
```

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ

```c
// –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–≤–µ–Ω—Å—Ç–≤–∞
static inline bool EQUAL_128(uint128_t a, uint128_t b);
static inline bool EQUAL_256(uint256_t a, uint256_t b);

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –Ω–æ–ª—å
static inline bool IS_ZERO_128(uint128_t a);
static inline bool IS_ZERO_256(uint256_t a);

// –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –≤–æ–∑–≤—Ä–∞—Ç–æ–º -1/0/1
static inline int compare128(uint128_t a, uint128_t b);
static inline int compare256(uint256_t a, uint256_t b);
```

### –ê—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

#### –°–ª–æ–∂–µ–Ω–∏–µ

```c
// –û—Å–Ω–æ–≤–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–ª–æ–∂–µ–Ω–∏—è
static inline int SUM_64_64(uint64_t a, uint64_t b, uint64_t* c);
static inline int SUM_128_128(uint128_t a, uint128_t b, uint128_t* c);
static inline int SUM_256_256(uint256_t a, uint256_t b, uint256_t* c);

// –°–ª–æ–∂–µ–Ω–∏–µ —Å –ø–µ—Ä–µ–Ω–æ—Å–æ–º (mixed precision)
static inline int ADD_64_INTO_128(uint64_t a, uint128_t *c);
static inline int ADD_128_INTO_256(uint128_t a, uint256_t* c);
static inline int ADD_256_INTO_512(uint256_t a, uint512_t* c);
```

#### –í—ã—á–∏—Ç–∞–Ω–∏–µ

```c
// –û—Å–Ω–æ–≤–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤—ã—á–∏—Ç–∞–Ω–∏—è
static inline int SUBTRACT_128_128(uint128_t a, uint128_t b, uint128_t* c);
static inline int SUBTRACT_256_256(uint256_t a, uint256_t b, uint256_t* c);

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è
static inline int OVERFLOW_SUM_64_64(uint64_t a, uint64_t b);
static inline int OVERFLOW_MULT_64_64(uint64_t a, uint64_t b);
```

#### –£–º–Ω–æ–∂–µ–Ω–∏–µ

```c
// –ë–∞–∑–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —É–º–Ω–æ–∂–µ–Ω–∏—è
static inline void MULT_64_128(uint64_t a, uint64_t b, uint128_t* c);
static inline int MULT_128_128(uint128_t a, uint128_t b, uint128_t* c);
static inline int MULT_256_256(uint256_t a, uint256_t b, uint256_t* c);

// –†–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ —É–º–Ω–æ–∂–µ–Ω–∏–µ
static inline void MULT_128_256(uint128_t a, uint128_t b, uint256_t* c);
static inline void MULT_256_512(uint256_t a, uint256_t b, uint512_t* c);
```

#### –î–µ–ª–µ–Ω–∏–µ

```c
// –û–ø–µ—Ä–∞—Ü–∏–∏ –¥–µ–ª–µ–Ω–∏—è
static inline void DIV_128(uint128_t a, uint128_t b, uint128_t* c);
static inline void DIV_256(uint256_t a, uint256_t b, uint256_t* c);

// –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–µ–ª–µ–Ω–∏—è (—Å –æ—Å—Ç–∞—Ç–∫–æ–º)
static inline void divmod_impl_128(uint128_t dividend, uint128_t divisor,
                                  uint128_t *quotient, uint128_t *remainder);
static inline void divmod_impl_256(uint256_t dividend, uint256_t divisor,
                                  uint256_t *quotient, uint256_t *remainder);
```

### –ü–æ–±–∏—Ç–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

```c
// –õ–æ–≥–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
static inline uint128_t AND_128(uint128_t a, uint128_t b);
static inline uint128_t OR_128(uint128_t a, uint128_t b);
static inline uint256_t AND_256(uint256_t a, uint256_t b);
static inline uint256_t OR_256(uint256_t a, uint256_t b);

// –°–¥–≤–∏–≥–∏
static inline void LEFT_SHIFT_128(uint128_t a, uint128_t* b, int n);
static inline void RIGHT_SHIFT_128(uint128_t a, uint128_t* b, int n);
static inline void LEFT_SHIFT_256(uint256_t a, uint256_t* b, int n);
static inline void RIGHT_SHIFT_256(uint256_t a, uint256_t* b, int n);
```

### –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç/–î–µ–∫—Ä–µ–º–µ–Ω—Ç

```c
// –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç
static inline void INCR_128(uint128_t *a);
static inline void INCR_256(uint256_t* a);

// –î–µ–∫—Ä–µ–º–µ–Ω—Ç
static inline void DECR_128(uint128_t* a);
static inline void DECR_256(uint256_t* a);
```

## –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### –†–∞–±–æ—Ç–∞ —Å –≤–µ–¥—É—â–∏–º–∏ –Ω—É–ª—è–º–∏

```c
// –ü–æ–¥—Å—á–µ—Ç –≤–µ–¥—É—â–∏—Ö –Ω—É–ª–µ–π
static inline int nlz64(uint64_t n);   // 64-bit
static inline int nlz128(uint128_t n); // 128-bit
static inline int nlz256(uint256_t n); // 256-bit

// –ü–æ–∏—Å–∫ —Å—Ç–∞—Ä—à–µ–≥–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ –±–∏—Ç–∞
static inline int fls128(uint128_t n);
static inline int fls256(uint256_t n);
```

### –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (DATOSHI)

```c
// –£–º–Ω–æ–∂–µ–Ω–∏–µ —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ç–æ—á–∫–æ–π (–¥–ª—è –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç)
static inline int _MULT_256_COIN(uint256_t a, uint256_t b, uint256_t* result, bool round);
#define MULT_256_COIN(a_val, b_val, res) _MULT_256_COIN(a_val, b_val, res, false)

// –î–µ–ª–µ–Ω–∏–µ —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ç–æ—á–∫–æ–π
static inline void DIV_256_COIN(uint256_t a, uint256_t b, uint256_t *res);
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ë–∞–∑–æ–≤—ã–µ –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

```c
#include "dap_math_ops.h"

// –†–∞–±–æ—Ç–∞ —Å 256-–±–∏—Ç–Ω—ã–º–∏ —á–∏—Å–ª–∞–º–∏
uint256_t a = GET_256_FROM_64(1000);
uint256_t b = GET_256_FROM_64(2000);
uint256_t result;

// –°–ª–æ–∂–µ–Ω–∏–µ
int overflow = SUM_256_256(a, b, &result);

// –£–º–Ω–æ–∂–µ–Ω–∏–µ
overflow = MULT_256_256(a, b, &result);

// –°—Ä–∞–≤–Ω–µ–Ω–∏–µ
int cmp = compare256(a, b);
if (cmp > 0) {
    printf("a > b\n");
}
```

### –†–∞–±–æ—Ç–∞ —Å –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–Ω—ã–º–∏ —Å—É–º–º–∞–º–∏

```c
// –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —Å—É–º–º—ã –≤ DATOSHI (1 —Ç–æ–∫–µ–Ω = 10^18 DATOSHI)
uint256_t token_amount = GET_256_FROM_64(1000000000000000000ULL); // 1 —Ç–æ–∫–µ–Ω
uint256_t price_per_token = GET_256_FROM_64(5000000000000000000ULL); // 5 —Ç–æ–∫–µ–Ω–æ–≤
uint256_t total_cost;

// –†–∞—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ —Å –æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ–º
int overflow = _MULT_256_COIN(token_amount, price_per_token, &total_cost, true);
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è

```c
uint64_t a = UINT64_MAX;
uint64_t b = 2;

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è –ø–µ—Ä–µ–¥ –æ–ø–µ—Ä–∞—Ü–∏–µ–π
if (OVERFLOW_MULT_64_64(a, b)) {
    printf("–ü–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–∏ —É–º–Ω–æ–∂–µ–Ω–∏–∏!\n");
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–∫–∏
} else {
    uint64_t result;
    MULT_64_64(a, b, &result);
}
```

### –†–∞–±–æ—Ç–∞ —Å –±–æ–ª—å—à–∏–º–∏ –º–∞—Å—Å–∏–≤–∞–º–∏

```c
// –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Ö—ç—à–∞ –±–æ–ª—å—à–æ–≥–æ –±–ª–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö
uint256_t hash_value = uint256_0;
uint256_t data_chunk;

// –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –±–ª–æ–∫–∞–º–∏
for (size_t i = 0; i < data_size / 32; i++) {
    // –ü–æ–ª—É—á–∏—Ç—å 256-–±–∏—Ç–Ω—ã–π –±–ª–æ–∫ –¥–∞–Ω–Ω—ã—Ö
    memcpy(&data_chunk, data + i * 32, 32);

    // XOR —Å –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—ã–º —Ö—ç—à–µ–º
    hash_value = OR_256(hash_value, data_chunk);
}
```

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

| –û–ø–µ—Ä–∞—Ü–∏—è | –° __int128 | –ë–µ–∑ __int128 | –£—Å–∫–æ—Ä–µ–Ω–∏–µ |
|----------|------------|--------------|-----------|
| –°–ª–æ–∂–µ–Ω–∏–µ 128-bit | 1 —Ü–∏–∫–ª | 5-10 —Ü–∏–∫–ª–æ–≤ | 5-10x |
| –£–º–Ω–æ–∂–µ–Ω–∏–µ 128-bit | 2 —Ü–∏–∫–ª–∞ | 50-100 —Ü–∏–∫–ª–æ–≤ | 25-50x |
| –î–µ–ª–µ–Ω–∏–µ 256-bit | 10 —Ü–∏–∫–ª–æ–≤ | 200-500 —Ü–∏–∫–ª–æ–≤ | 20-50x |

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

1. **Inline —Ñ—É–Ω–∫—Ü–∏–∏**: –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∫–∞–∫ `static inline`
2. **–í–µ—Ç–≤–ª–µ–Ω–∏–µ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞**: –†–∞–∑–Ω—ã–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä
3. **SIMD –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤–µ–∫—Ç–æ—Ä–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ
4. **–ö–æ–Ω—Å—Ç–∞–Ω—Ç–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è**: –ö–æ–º–ø–∏–ª—è—Ç–æ—Ä –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- **–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–µ–ª–µ–Ω–∏—è –Ω–∞ –Ω–æ–ª—å**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è SIGFPE
- **Assert –ø—Ä–æ–≤–µ—Ä–∫–∏**: –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤ debug —Å–±–æ—Ä–∫–∞—Ö
- **–ü–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ**: –í–æ–∑–≤—Ä–∞—Ç —Ñ–ª–∞–≥–æ–≤ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- **Type safety**: –°—Ç—Ä–æ–≥–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ DAP SDK

–ú–æ–¥—É–ª—å —è–≤–ª—è–µ—Ç—Å—è —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–æ–º –¥–ª—è:

### üí∞ **–ö—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏**
```c
// –†–∞—Å—á–µ—Ç –∫–æ–º–∏—Å—Å–∏–∏ –∑–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
uint256_t transaction_amount = GET_256_FROM_64(1000000000); // 1e9 DATOSHI
uint256_t fee_percent = GET_256_FROM_64(5000000000000000); // 0.005 = 5e15
uint256_t fee_amount;

_MULT_256_COIN(transaction_amount, fee_percent, &fee_amount, true);
```

### üîê **–ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è**
```c
// –ú–æ–¥—É–ª—è—Ä–Ω–∞—è –∞—Ä–∏—Ñ–º–µ—Ç–∏–∫–∞ –¥–ª—è —Ü–∏—Ñ—Ä–æ–≤—ã—Ö –ø–æ–¥–ø–∏—Å–µ–π
uint256_t private_key = generate_private_key();
uint256_t modulus = secp256k1_modulus;
uint256_t signature;

// –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∏: (message * private_key) mod modulus
MULT_256_256(message_hash, private_key, &temp);
divmod_impl_256(temp, modulus, &signature, &remainder);
```

### üè¶ **–ë–ª–æ–∫—á–µ–π–Ω –æ–ø–µ—Ä–∞—Ü–∏–∏**
```c
// –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–∞ –∫–æ—à–µ–ª—å–∫–∞
uint256_t wallet_balance = load_wallet_balance();
uint256_t transaction_amount = GET_256_FROM_64(5000000000000000000ULL); // 5 —Ç–æ–∫–µ–Ω–æ–≤

if (compare256(wallet_balance, transaction_amount) >= 0) {
    // –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤ –¥–ª—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
    SUBTRACT_256_256(wallet_balance, transaction_amount, &new_balance);
    save_wallet_balance(new_balance);
}
```

## –°–≤—è–∑–∞–Ω–Ω—ã–µ –º–æ–¥—É–ª–∏

- `dap_math_convert.h` - –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –º–µ–∂–¥—É —Å—Ç—Ä–æ–∫–∞–º–∏ –∏ —á–∏—Å–ª–∞–º–∏
- `dap_common.h` - –û–±—â–∏–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∏ –º–∞–∫—Ä–æ—Å—ã
- `dap_crypto_common.h` - –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã

## –ó–∞–º–µ—á–∞–Ω–∏—è –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –ü–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ
```c
// –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è
uint256_t a = uint256_max;
uint256_t b = GET_256_FROM_64(2);
uint256_t result;

int overflow = SUM_256_256(a, b, &result);
if (overflow) {
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è
    handle_overflow();
}
```

### –î–µ–ª–µ–Ω–∏–µ –Ω–∞ –Ω–æ–ª—å
```c
// –ó–∞—â–∏—Ç–∞ –æ—Ç –¥–µ–ª–µ–Ω–∏—è –Ω–∞ –Ω–æ–ª—å
if (IS_ZERO_256(divisor)) {
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–∫–∏
    return ERROR_DIVISION_BY_ZERO;
}

DIV_256(dividend, divisor, &quotient);
```

### –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
```c
// –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
assert(compare256(a, uint256_0) >= 0); // –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ —á–∏—Å–ª–∞
assert(compare256(b, uint256_0) > 0);  // –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π –¥–µ–ª–∏—Ç–µ–ª—å
```

## –û—Ç–ª–∞–¥–∫–∞ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ú–æ–¥—É–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã

```c
// –¢–µ—Å—Ç –±–∞–∑–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
void test_basic_operations() {
    uint256_t a = GET_256_FROM_64(100);
    uint256_t b = GET_256_FROM_64(200);
    uint256_t result;

    // –¢–µ—Å—Ç —Å–ª–æ–∂–µ–Ω–∏—è
    SUM_256_256(a, b, &result);
    assert(compare256(result, GET_256_FROM_64(300)) == 0);

    // –¢–µ—Å—Ç —É–º–Ω–æ–∂–µ–Ω–∏—è
    MULT_256_256(a, b, &result);
    assert(compare256(result, GET_256_FROM_64(20000)) == 0);
}
```

### –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

```c
// –ò–∑–º–µ—Ä–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –æ–ø–µ—Ä–∞—Ü–∏–π
clock_t start = clock();
for (int i = 0; i < 1000000; i++) {
    MULT_256_256(a, b, &result);
}
clock_t end = clock();
double time_spent = (double)(end - start) / CLOCKS_PER_SEC;
printf("1M —É–º–Ω–æ–∂–µ–Ω–∏–π: %.3f —Å–µ–∫—É–Ω–¥\n", time_spent);
```

## –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º

```c
// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π
#ifdef __x86_64__
    // SSE/AVX –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –¥–ª—è x86
#endif

#ifdef __ARM_NEON__
    // NEON –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –¥–ª—è ARM
#endif
```

### –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

```c
// –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –∫–æ–Ω—Å—Ç–∞–Ω—Ç
static const uint256_t TEN18 = GET_256_FROM_64(1000000000000000000ULL);
static const uint256_t ZERO_POINT_FIVE = GET_256_FROM_64(500000000000000000ULL);
```

### –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è

```c
// –í–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
#pragma omp parallel for
for (int i = 0; i < num_operations; i++) {
    MULT_256_256(operands_a[i], operands_b[i], &results[i]);
}
```

–≠—Ç–æ—Ç –º–æ–¥—É–ª—å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –≤—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã–π —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç –¥–ª—è –≤—Å–µ—Ö –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –≤ DAP SDK, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã —Å –±–æ–ª—å—à–∏–º–∏ —á–∏—Å–ª–∞–º–∏ –≤ –±–ª–æ–∫—á–µ–π–Ω –∏ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö.

