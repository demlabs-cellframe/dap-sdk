# DAP Public Key Module (dap_pkey.h)

## –û–±–∑–æ—Ä

–ú–æ–¥—É–ª—å `dap_pkey.h` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø—É–±–ª–∏—á–Ω—ã–º–∏ –∫–ª—é—á–∞–º–∏ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –≤ DAP SDK. –û–Ω –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è, —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø—É–±–ª–∏—á–Ω—ã—Ö –∫–ª—é—á–µ–π —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤.

## –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–ú–æ–¥—É–ª—å –ø—É–±–ª–∏—á–Ω—ã—Ö –∫–ª—é—á–µ–π —Å–ª—É–∂–∏—Ç —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–º –¥–ª—è:

- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–º–∏ –∫–ª—é—á–∞–º–∏** —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤
- **–ü–æ–¥–¥–µ—Ä–∂–∫–∏ –ø–æ—Å—Ç-–∫–≤–∞–Ω—Ç–æ–≤—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤** —Ü–∏—Ñ—Ä–æ–≤—ã—Ö –ø–æ–¥–ø–∏—Å–µ–π
- **–£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ API** –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–ª—é—á–∞–º–∏ —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è** –∏ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–ª—é—á–µ–π
- **–í–∞–ª–∏–¥–∞—Ü–∏–∏** –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –∫–ª—é—á–µ–π

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```mermaid
graph TB
    subgraph "DAP Public Key Architecture"
        A[dap_pkey_t] --> B[dap_pkey_type_t]
        B --> C[Algorithm-specific types]

        D[Key Operations] --> E[dap_pkey_generate()]
        D --> F[dap_pkey_serialize()]
        D --> G[dap_pkey_deserialize()]
        D --> H[dap_pkey_compare()]

        I[Supported Types] --> J[PQC Signatures]
        I --> K[Classical Signatures]
        I --> L[Multi-signature]
        I --> M[Chained signatures]
    end
```

## –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### üîë **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª—é—á–∞–º–∏**
- –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª—é—á–µ–π —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤
- –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏ –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–ª—é—á–µ–π
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è –∫–ª—é—á–µ–π
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ —Ö—Ä–∞–Ω–µ–Ω–∏—è

### üîê **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤**
- –ü–æ—Å—Ç-–∫–≤–∞–Ω—Ç–æ–≤—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã —Ü–∏—Ñ—Ä–æ–≤—ã—Ö –ø–æ–¥–ø–∏—Å–µ–π
- –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã (ECDSA)
- –ú—É–ª—å—Ç–∏-–ø–æ–¥–ø–∏—Å–∏ –∏ chained-–ø–æ–¥–ø–∏—Å–∏
- –†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å –¥–ª—è –Ω–æ–≤—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤

### üìä **–§–æ—Ä–º–∞—Ç—ã –¥–∞–Ω–Ω—ã—Ö**
- –ë–∏–Ω–∞—Ä–Ω–∞—è —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è
- Base64 –∫–æ–¥–∏—Ä–æ–≤–∫–∞
- Hexadecimal –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ
- –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏

## –¢–∏–ø—ã –ø—É–±–ª–∏—á–Ω—ã—Ö –∫–ª—é—á–µ–π

### –ü–æ—Å—Ç-–∫–≤–∞–Ω—Ç–æ–≤—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã —Ü–∏—Ñ—Ä–æ–≤—ã—Ö –ø–æ–¥–ø–∏—Å–µ–π

```c
enum dap_pkey_type_enum {
    // –ü–æ—Å—Ç-–∫–≤–∞–Ω—Ç–æ–≤—ã–µ –ø–æ–¥–ø–∏—Å–∏
    DAP_PKEY_TYPE_SIGN_BLISS = 0x0901,        // BLISS signature
    DAP_PKEY_TYPE_SIGN_TESLA = 0x0902,        // TESLA signature
    DAP_PKEY_TYPE_SIGN_DILITHIUM = 0x0903,    // Dilithium signature
    DAP_PKEY_TYPE_SIGN_PICNIC = 0x0904,       // Picnic signature
    DAP_PKEY_TYPE_SIGN_FALCON = 0x0905,       // Falcon signature
    DAP_PKEY_TYPE_SIGN_SPHINCSPLUS = 0x0906,  // SPHINCS+ signature
    DAP_PKEY_TYPE_SIGN_SHIPOVNIK = 0x0908,    // Shipovnik signature

    // –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã
    DAP_PKEY_TYPE_SIGN_ECDSA = 0x0907,        // ECDSA signature

    // –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Ç–∏–ø—ã
    DAP_PKEY_TYPE_MULTI_CHAINED = 0xfffe,     // Chained multi-signature
    DAP_PKEY_TYPE_MULTI = 0xffff              // Multi-signature
};
```

## API Reference

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

```c
// –û—Å–Ω–æ–≤–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∫–ª—é—á–∞
typedef struct dap_pkey {
    dap_pkey_type_t type;           // –¢–∏–ø –∫–ª—é—á–∞
    size_t size;                    // –†–∞–∑–º–µ—Ä –∫–ª—é—á–∞ –≤ –±–∞–π—Ç–∞—Ö
    uint8_t *pkey;                  // –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –¥–∞–Ω–Ω—ã–µ –∫–ª—é—á–∞
} dap_pkey_t;

// –¢–∏–ø –∫–ª—é—á–∞ (union –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏)
typedef union dap_pkey_type {
    dap_pkey_type_enum_t type;      // –ü–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ —Ç–∏–ø–∞
    uint16_t raw;                   // –°—ã—Ä–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
} dap_pkey_type_t;
```

### –°–æ–∑–¥–∞–Ω–∏–µ –∏ —É–Ω–∏—á—Ç–æ–∂–µ–Ω–∏–µ –∫–ª—é—á–µ–π

```c
// –°–æ–∑–¥–∞–Ω–∏–µ –ø—É—Å—Ç–æ–≥–æ –∫–ª—é—á–∞
dap_pkey_t *dap_pkey_new(void);

// –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª—é—á–∞ –∏–∑ –¥–∞–Ω–Ω—ã—Ö
dap_pkey_t *dap_pkey_from_data(const void *data, size_t size, dap_pkey_type_t type);

// –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –∫–ª—é—á–∞
dap_pkey_t *dap_pkey_generate(dap_pkey_type_t type);

// –£–Ω–∏—á—Ç–æ–∂–µ–Ω–∏–µ –∫–ª—é—á–∞
void dap_pkey_delete(dap_pkey_t *pkey);
```

### –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏ –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è

```c
// –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–ª—é—á–∞ –≤ –±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
size_t dap_pkey_serialize(dap_pkey_t *pkey, uint8_t *buf, size_t buf_size);

// –î–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–ª—é—á–∞ –∏–∑ –±–∏–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞
dap_pkey_t *dap_pkey_deserialize(const uint8_t *data, size_t data_size);

// –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ —Å–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–ª—é—á–∞
size_t dap_pkey_serialized_size(dap_pkey_t *pkey);
```

### –û–ø–µ—Ä–∞—Ü–∏–∏ —Å –∫–ª—é—á–∞–º–∏

```c
// –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–≤—É—Ö –∫–ª—é—á–µ–π
int dap_pkey_compare(dap_pkey_t *pkey1, dap_pkey_t *pkey2);

// –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–∏–ø–∞ –∫–ª—é—á–∞
dap_pkey_type_t dap_pkey_type(dap_pkey_t *pkey);

// –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –∫–ª—é—á–∞
size_t dap_pkey_size(dap_pkey_t *pkey);

// –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–ª—é—á–∞
bool dap_pkey_validate(dap_pkey_t *pkey);
```

### –†–∞–±–æ—Ç–∞ —Å —Ç–∏–ø–∞–º–∏ –∫–ª—é—á–µ–π

```c
// –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ç–∏–ø–∞ –≤ —Å—Ç—Ä–æ–∫—É
const char *dap_pkey_type_to_str(dap_pkey_type_t type);

// –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏ –≤ —Ç–∏–ø
dap_pkey_type_t dap_pkey_type_from_str(const char *str);

// –ü—Ä–æ–≤–µ—Ä–∫–∞, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Ç–∏–ø –ø–æ—Å—Ç-–∫–≤–∞–Ω—Ç–æ–≤—ã–º
bool dap_pkey_type_is_pqc(dap_pkey_type_t type);

// –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –∞–ª–≥–æ—Ä–∏—Ç–º–µ
const char *dap_pkey_type_get_info(dap_pkey_type_t type);
```

## –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã

### üî¨ **–ü–æ—Å—Ç-–∫–≤–∞–Ω—Ç–æ–≤—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã**

#### BLISS (0x0901)
- **–¢–∏–ø**: –ü–æ—Å—Ç-–∫–≤–∞–Ω—Ç–æ–≤–∞—è —Ü–∏—Ñ—Ä–æ–≤–∞—è –ø–æ–¥–ø–∏—Å—å
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –û—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ —Ä–µ—à–µ–Ω–∏–∏ –∑–∞–¥–∞—á –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**: –ë—ã—Å—Ç—Ä–∞—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è, –∫–æ–º–ø–∞–∫—Ç–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∏
- **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ**: –¶–∏—Ñ—Ä–æ–≤—ã–µ –ø–æ–¥–ø–∏—Å–∏ –≤ –±–ª–æ–∫—á–µ–π–Ω —Å–∏—Å—Ç–µ–º–∞—Ö

#### Dilithium (0x0903)
- **–¢–∏–ø**: –ü–æ—Å—Ç-–∫–≤–∞–Ω—Ç–æ–≤–∞—è —Ü–∏—Ñ—Ä–æ–≤–∞—è –ø–æ–¥–ø–∏—Å—å
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –û—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ –ø—Ä–æ–±–ª–µ–º–µ Module-LWE
- **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**: –í—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω NIST
- **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ**: –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Ü–∏—Ñ—Ä–æ–≤—ã–µ –ø–æ–¥–ø–∏—Å–∏

#### Falcon (0x0905)
- **–¢–∏–ø**: –ü–æ—Å—Ç-–∫–≤–∞–Ω—Ç–æ–≤–∞—è —Ü–∏—Ñ—Ä–æ–≤–∞—è –ø–æ–¥–ø–∏—Å—å
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –û—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ –ø—Ä–æ–±–ª–µ–º–µ NTRU
- **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**: –ö–æ–º–ø–∞–∫—Ç–Ω—ã–µ –∫–ª—é—á–∏ –∏ –ø–æ–¥–ø–∏—Å–∏
- **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ**: –†–µ—Å—É—Ä—Å–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

#### SPHINCS+ (0x0906)
- **–¢–∏–ø**: –ü–æ—Å—Ç-–∫–≤–∞–Ω—Ç–æ–≤–∞—è —Ü–∏—Ñ—Ä–æ–≤–∞—è –ø–æ–¥–ø–∏—Å—å
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –û—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ —Ö–µ—à-—Ñ—É–Ω–∫—Ü–∏—è—Ö
- **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**: –í—ã—Å–æ–∫–∞—è –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è —Å—Ç–æ–π–∫–æ—Å—Ç—å
- **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ**: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### üèõÔ∏è **–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã**

#### ECDSA (0x0907)
- **–¢–∏–ø**: –¶–∏—Ñ—Ä–æ–≤–∞—è –ø–æ–¥–ø–∏—Å—å –Ω–∞ —ç–ª–ª–∏–ø—Ç–∏—á–µ—Å–∫–∏—Ö –∫—Ä–∏–≤—ã—Ö
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –û—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ –¥–∏—Å–∫—Ä–µ—Ç–Ω–æ–º –ª–æ–≥–∞—Ä–∏—Ñ–º–µ
- **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**: –®–∏—Ä–æ–∫–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞, —Ö–æ—Ä–æ—à–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ**: –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### üîó **–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Ç–∏–ø—ã**

#### Multi-signature (0xffff)
- **–¢–∏–ø**: –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∏
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–æ–¥–ø–∏—Å–µ–π –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ**: –ú–Ω–æ–≥–æ—Å—Ç–æ—Ä–æ–Ω–Ω–∏–µ –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã, –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

#### Chained multi-signature (0xfffe)
- **–¢–∏–ø**: –¶–µ–ø–æ—á–µ—á–Ω—ã–µ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∏
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–¥–ø–∏—Å–∞–Ω–∏–µ —Å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏
- **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ**: –°–ª–æ–∂–Ω—ã–µ –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å—ã

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ë–∞–∑–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –∫–ª—é—á–∞–º–∏

```c
#include "dap_pkey.h"

// –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø–æ—Å—Ç-–∫–≤–∞–Ω—Ç–æ–≤–æ–≥–æ –∫–ª—é—á–∞ (Dilithium)
dap_pkey_t *pkey = dap_pkey_generate(DAP_PKEY_TYPE_SIGN_DILITHIUM);

// –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–ª—é—á–∞
size_t serialized_size = dap_pkey_serialized_size(pkey);
uint8_t *serialized_data = malloc(serialized_size);
size_t actual_size = dap_pkey_serialize(pkey, serialized_data, serialized_size);

// –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ —Ñ–∞–π–ª –∏–ª–∏ –ø–µ—Ä–µ–¥–∞—á–∞ –ø–æ —Å–µ—Ç–∏
save_to_file("public_key.bin", serialized_data, actual_size);

// –î–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–ª—é—á–∞
dap_pkey_t *restored_pkey = dap_pkey_deserialize(serialized_data, actual_size);

// –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∫–ª—é—á–µ–π
if (dap_pkey_compare(pkey, restored_pkey) == 0) {
    printf("–ö–ª—é—á–∏ –∏–¥–µ–Ω—Ç–∏—á–Ω—ã\n");
}

// –û—á–∏—Å—Ç–∫–∞
dap_pkey_delete(pkey);
dap_pkey_delete(restored_pkey);
free(serialized_data);
```

### –†–∞–±–æ—Ç–∞ —Å —Ç–∏–ø–∞–º–∏ –∫–ª—é—á–µ–π

```c
// –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ç–∏–ø–µ –∫–ª—é—á–∞
dap_pkey_type_t key_type = DAP_PKEY_TYPE_SIGN_FALCON;
const char *type_str = dap_pkey_type_to_str(key_type);
printf("–¢–∏–ø –∫–ª—é—á–∞: %s\n", type_str);

// –ü—Ä–æ–≤–µ—Ä–∫–∞, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Ç–∏–ø –ø–æ—Å—Ç-–∫–≤–∞–Ω—Ç–æ–≤—ã–º
if (dap_pkey_type_is_pqc(key_type)) {
    printf("–≠—Ç–æ –ø–æ—Å—Ç-–∫–≤–∞–Ω—Ç–æ–≤—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º\n");
}

// –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
const char *info = dap_pkey_type_get_info(key_type);
printf("–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è: %s\n", info);
```

### –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–ª—é—á–µ–π

```c
// –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª—é—á–∞ –∏–∑ –≤–Ω–µ—à–Ω–∏—Ö –¥–∞–Ω–Ω—ã—Ö
uint8_t external_key_data[1024]; // –í–Ω–µ—à–Ω–∏–µ –¥–∞–Ω–Ω—ã–µ –∫–ª—é—á–∞
dap_pkey_t *external_pkey = dap_pkey_from_data(external_key_data,
                                              sizeof(external_key_data),
                                              DAP_PKEY_TYPE_SIGN_ECDSA);

// –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–ª—é—á–∞
if (dap_pkey_validate(external_pkey)) {
    printf("–ö–ª—é—á –≤–∞–ª–∏–¥–µ–Ω\n");

    // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–ª—é—á–∞ –¥–ª—è –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
    // ...

} else {
    printf("–ö–ª—é—á –Ω–µ–≤–∞–ª–∏–¥–µ–Ω\n");
    dap_pkey_delete(external_pkey);
}
```

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### üîí **–ú–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**
- **–í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç—å—é**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **–ö–æ–Ω—Å—Ç–∞–Ω—Ç–Ω–æ–µ –≤—Ä–µ–º—è –æ–ø–µ—Ä–∞—Ü–∏–π**: –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –∞—Ç–∞–∫ –ø–æ –≤—Ä–µ–º–µ–Ω–∏
- **–ó–∞—â–∏—Ç–∞ –æ—Ç side-channel –∞—Ç–∞–∫**: –ú–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã—Ö —É—Ç–µ—á–µ–∫

### ‚ö†Ô∏è **–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è**
- –í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π
- –í–∞–ª–∏–¥–∏—Ä—É–π—Ç–µ –∫–ª—é—á–∏ –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–π —Ç–∏–ø –∫–ª—é—á–∞ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∑–∞–¥–∞—á–∏
- –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –∫–ª—é—á–∏

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### üìà **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏**
- **–ü–ª–∞—Ç—Ñ–æ—Ä–º–æ-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–π –∫–æ–¥**: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä
- **–í–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ SIMD –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π
- **–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ**: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- **Lazy evaluation**: –û—Ç–ª–æ–∂–µ–Ω–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### üìä **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞–º**

| –ê–ª–≥–æ—Ä–∏—Ç–º | –û–ø–µ—Ä–∞—Ü–∏—è | –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å |
|----------|----------|-------------------|
| Dilithium | –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–∞ | ~1 —Å–µ–∫ |
| Dilithium | –ü–æ–¥–ø–∏—Å—å | ~10 –º—Å |
| Dilithium | –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è | ~1 –º—Å |
| Falcon | –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–∞ | ~2 —Å–µ–∫ |
| Falcon | –ü–æ–¥–ø–∏—Å—å | ~50 –º—Å |
| Falcon | –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è | ~5 –º—Å |
| ECDSA | –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–∞ | ~100 –º—Å |
| ECDSA | –ü–æ–¥–ø–∏—Å—å | ~1 –º—Å |
| ECDSA | –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è | ~2 –º—Å |

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥—Ä—É–≥–∏–º–∏ –º–æ–¥—É–ª—è–º–∏

### üîó **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**
- **dap_common.h**: –ë–∞–∑–æ–≤—ã–µ —Ç–∏–ø—ã –∏ —É—Ç–∏–ª–∏—Ç—ã
- **dap_enc_key.h**: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π –∫–ª—é—á–µ–π —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
- **dap_sign.h**: –¶–∏—Ñ—Ä–æ–≤—ã–µ –ø–æ–¥–ø–∏—Å–∏
- **–ê–ª–≥–æ—Ä–∏—Ç–º-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –º–æ–¥—É–ª–∏**: –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ PQC –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤

### üîÑ **–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ**
- **–° dap_sign.h**: –î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ–¥–ø–∏—Å–µ–π
- **–° dap_cert.h**: –î–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞–º–∏
- **–° —Å–µ—Ç–µ–≤—ã–º–∏ –º–æ–¥—É–ª—è–º–∏**: –î–ª—è –æ–±–º–µ–Ω–∞ –∫–ª—é—á–∞–º–∏
- **–° —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º**: –î–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–ª—é—á–µ–π

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### üß™ **–ù–∞–±–æ—Ä —Ç–µ—Å—Ç–æ–≤**
```bash
# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –ø—É–±–ª–∏—á–Ω—ã—Ö –∫–ª—é—á–µ–π
make test_pkey

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞
make test_pkey_dilithium
make test_pkey_falcon
make test_pkey_ecdsa

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏
make test_pkey_serialization

# –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
make benchmark_pkey
```

### ‚úÖ **–ö—Ä–∏—Ç–µ—Ä–∏–∏ –∫–∞—á–µ—Å—Ç–≤–∞**
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–ª—é—á–µ–π
- –ü—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏/–¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏
- –í–∞–ª–∏–¥–Ω–æ—Å—Ç—å –ø–æ–¥–ø–∏—Å–µ–π –∏ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–π
- –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞–º–∏

## –û—Ç–ª–∞–¥–∫–∞ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### üîç **–û—Ç–ª–∞–¥–æ—á–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏**
```c
// –í–∫–ª—é—á–µ–Ω–∏–µ –æ—Ç–ª–∞–¥–∫–∏
DAP_LOG_DEBUG("PKey operation: %s", operation_name);

// –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–ª—é—á–µ
DAP_LOG_DEBUG("Key type: %s, size: %zu",
              dap_pkey_type_to_str(pkey->type),
              dap_pkey_size(pkey));
```

### üìä **–ú–µ—Ç—Ä–∏–∫–∏**
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –∫–ª—é—á–µ–π
- –í—Ä–µ–º—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–ª—é—á–µ–π
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–ø–µ—Ä–∞—Ü–∏–π —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏
- –ü—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—à–Ω—ã—Ö –≤–∞–ª–∏–¥–∞—Ü–∏–π

## –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

### üöÄ **–ü–ª–∞–Ω—ã —Ä–∞–∑–≤–∏—Ç–∏—è**
- **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ PQC –∞–ª–≥–æ—Ä–∏—Ç–º—ã**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–æ–≤—ã—Ö –ø–æ—Å—Ç-–∫–≤–∞–Ω—Ç–æ–≤—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤
- **–ê–ø–ø–∞—Ä–∞—Ç–Ω–æ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å–æ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–≤
- **–ö–≤–∞–Ω—Ç–æ–≤–æ-—É—Å—Ç–æ–π—á–∏–≤—ã–µ —Å—Ö–µ–º—ã**: –ù–æ–≤—ã–µ —Ç–∏–ø—ã –∫–ª—é—á–µ–π –¥–ª—è –∫–≤–∞–Ω—Ç–æ–≤–æ–π —ç—Ä—ã
- **–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª—é—á–∞–º–∏**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ threshold –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–∏

### üîÆ **–ò—Å—Å–ª–µ–¥—É–µ–º—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏**
- **Threshold signatures**: –ü–æ–¥–ø–∏—Å–∏ —Å –ø–æ—Ä–æ–≥–æ–º –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º
- **Verifiable delay functions**: –§—É–Ω–∫—Ü–∏–∏ —Å –ø—Ä–æ–≤–µ—Ä—è–µ–º–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π
- **Zero-knowledge proofs**: –î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞ —Å –Ω—É–ª–µ–≤—ã–º —Ä–∞–∑–≥–ª–∞—à–µ–Ω–∏–µ–º –¥–ª—è –∫–ª—é—á–µ–π

---

*–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç —è–≤–ª—è–µ—Ç—Å—è —á–∞—Å—Ç—å—é —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ DAP SDK. –î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –∏–ª–∏ –∫ –∫–æ–º–∞–Ω–¥–µ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤.*
