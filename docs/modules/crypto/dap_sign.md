# dap_sign.h - –¶–∏—Ñ—Ä–æ–≤—ã–µ –ø–æ–¥–ø–∏—Å–∏ –∏ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

## ‚ö†Ô∏è **–í–ê–ñ–ù–û–ï –ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–ï –û –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò**

# üö® **–ö–í–ê–ù–¢–û–í–ê–Ø –ù–ï–ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨ –ö–õ–ê–°–°–ò–ß–ï–°–ö–ò–• –ê–õ–ì–û–†–ò–¢–ú–û–í**

**–ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã —Ü–∏—Ñ—Ä–æ–≤—ã—Ö –ø–æ–¥–ø–∏—Å–µ–π –≤ DAP SDK —è–≤–ª—è—é—Ç—Å—è –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–º–∏ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–º–∏ –º–µ—Ç–æ–¥–∞–º–∏ –∏ –ù–ï –û–ë–ï–°–ü–ï–ß–ò–í–ê–Æ–¢ –ó–ê–©–ò–¢–£ –û–¢ –ê–¢–ê–ö –ö–í–ê–ù–¢–û–í–´–• –ö–û–ú–ü–¨–Æ–¢–ï–†–û–í.**

### **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è:**
- ‚úÖ **–ü–æ—Å—Ç-–∫–≤–∞–Ω—Ç–æ–≤—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã**: Falcon, Dilithium, Kyber - –ë–ï–ó–û–ü–ê–°–ù–´
- ‚ùå **–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã**: ECDSA - –£–Ø–ó–í–ò–ú–´ –∫ –∫–≤–∞–Ω—Ç–æ–≤—ã–º –∞—Ç–∞–∫–∞–º
- ‚ùå **–ù–ï –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø** –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –≤ –Ω–æ–≤—ã—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö
- ‚úÖ **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –¥–ª—è –ª–µ–≥–∞—Å–∏-—Å–∏—Å—Ç–µ–º

### **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –Ω–æ–≤—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤:**
üü¢ **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ—Å—Ç-–∫–≤–∞–Ω—Ç–æ–≤—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã:**
- **Falcon** (NIST finalist, —Ä–µ—à–µ—Ç–æ—á–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∏)
- **Dilithium** (NIST finalist, –º–æ–¥—É–ª—è—Ä–Ω—ã–µ —Ä–µ—à–µ—Ç–∫–∏)
- **Kyber** (NIST finalist, –¥–ª—è –æ–±–º–µ–Ω–∞ –∫–ª—é—á–∞–º–∏)

üî¥ **–ò–∑–±–µ–≥–∞–π—Ç–µ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤:**
- **ECDSA** (—É—è–∑–≤–∏–º –∫ –∞–ª–≥–æ—Ä–∏—Ç–º—É –®–æ—Ä–∞)

---

## –û–±–∑–æ—Ä

–ú–æ–¥—É–ª—å `dap_sign` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ü–∏—Ñ—Ä–æ–≤—ã–º–∏ –ø–æ–¥–ø–∏—Å—è–º–∏ –≤ DAP SDK. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∫–∞–∫ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã (ECDSA –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏), —Ç–∞–∫ –∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–æ—Å—Ç-–∫–≤–∞–Ω—Ç–æ–≤—ã–µ –ø–æ–¥–ø–∏—Å–∏ (Dilithium, Falcon). –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –≤—ã—Å–æ–∫—É—é –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö.

## –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–ú–Ω–æ–∂–µ—Å—Ç–≤–æ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –ø–æ–¥–ø–∏—Å–µ–π**: –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ –∏ –ø–æ—Å—Ç-–∫–≤–∞–Ω—Ç–æ–≤—ã–µ
- **–ì–∏–±–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ç–∏–ø–æ–≤**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ –ø–æ–¥–ø–∏—Å–µ–π
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ª–∏–Ω–Ω–æ—Å—Ç–∏ –ø–æ–¥–ø–∏—Å–µ–π
- **–°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è**: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–µ–π
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –∫–ª—é—á–∞–º–∏**: –°–≤—è–∑—å —Å —Å–∏—Å—Ç–µ–º–æ–π —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–ª—é—á–∞–º–∏

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –¢–∏–ø—ã –ø–æ–¥–ø–∏—Å–µ–π

```c
typedef enum dap_sign_type_enum {
    // –ë–∞–∑–æ–≤—ã–µ —Ç–∏–ø—ã
    SIG_TYPE_NULL = 0x0000,           // –ü—É—Å—Ç–∞—è –ø–æ–¥–ø–∏—Å—å
    SIG_TYPE_BLISS = 0x0001,          // BLISS –ø–æ–¥–ø–∏—Å—å
    SIG_TYPE_TESLA = 0x0003,          // TESLA –ø–æ–¥–ø–∏—Å—å

    // –ü–æ—Å—Ç-–∫–≤–∞–Ω—Ç–æ–≤—ã–µ –ø–æ–¥–ø–∏—Å–∏
    SIG_TYPE_PICNIC = 0x0101,         // Picnic ZKP-–ø–æ–¥–ø–∏—Å—å
    SIG_TYPE_DILITHIUM = 0x0102,      // Dilithium (NIST finalist)
    SIG_TYPE_FALCON = 0x0103,         // Falcon (NIST finalist)
    SIG_TYPE_SPHINCSPLUS = 0x0104,    // Sphincs+ (NIST finalist)

    // –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ –ø–æ–¥–ø–∏—Å–∏
    SIG_TYPE_ECDSA = 0x0105,          // ECDSA
    SIG_TYPE_SHIPOVNIK = 0x0106,      // Shipovnik (Ring signatures)

    // –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ
    SIG_TYPE_MULTI_CHAINED = 0x0f00,  // –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ –ø–æ–¥–ø–∏—Å–∏
    SIG_TYPE_MULTI_COMBINED = 0x0f01, // –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∏

    // PQLR –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
    SIG_TYPE_PQLR_DILITHIUM = 0x1102, // PQLR Dilithium
    SIG_TYPE_PQLR_FALCON = 0x1103,    // PQLR Falcon
    SIG_TYPE_PQLR_SPHINCS = 0x1104    // PQLR Sphincs+
} dap_sign_type_enum_t;
```

### –¢–∏–ø—ã —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –ø–æ–¥–ø–∏—Å–µ–π

```c
#define DAP_SIGN_HASH_TYPE_NONE      0x00  // –ë–µ–∑ —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
#define DAP_SIGN_HASH_TYPE_SHA3      0x01  // SHA-3
#define DAP_SIGN_HASH_TYPE_STREEBOG  0x02  // Streebog (–ì–û–°–¢)
#define DAP_SIGN_HASH_TYPE_SIGN      0x0e  // –°–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ–µ –¥–ª—è –ø–æ–¥–ø–∏—Å–∏
#define DAP_SIGN_HASH_TYPE_DEFAULT   0x0f  // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞–≥–æ–ª–æ–≤–∫–∞ –ø–æ–¥–ø–∏—Å–∏

```c
typedef struct dap_sign_hdr {
    dap_sign_type_t type;        // –¢–∏–ø –ø–æ–¥–ø–∏—Å–∏
    uint8_t hash_type;           // –¢–∏–ø —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
    uint8_t padding;             // –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ
    uint32_t sign_size;          // –†–∞–∑–º–µ—Ä –ø–æ–¥–ø–∏—Å–∏
    uint32_t sign_pkey_size;     // –†–∞–∑–º–µ—Ä –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∫–ª—é—á–∞
} DAP_ALIGN_PACKED dap_sign_hdr_t;
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–æ–¥–ø–∏—Å–∏

```c
typedef struct dap_sign {
    dap_sign_hdr_t header;       // –ó–∞–≥–æ–ª–æ–≤–æ–∫ –ø–æ–¥–ø–∏—Å–∏
    uint8_t pkey_n_sign[];       // –ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á + –ø–æ–¥–ø–∏—Å—å
} DAP_ALIGN_PACKED dap_sign_t;
```

## API Reference

### –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è

#### dap_sign_init()
```c
int dap_sign_init(uint8_t a_sign_hash_type_default);
```
**–û–ø–∏—Å–∞–Ω–∏–µ**: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Å–∏—Å—Ç–µ–º—É —Ü–∏—Ñ—Ä–æ–≤—ã—Ö –ø–æ–¥–ø–∏—Å–µ–π.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
- `a_sign_hash_type_default` - —Ç–∏–ø —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç**:
- `0` - —É—Å–ø–µ—Ö
- `-1` - –æ—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏

**–ü—Ä–∏–º–µ—Ä**:
```c
#include "dap_sign.h"

int main() {
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å SHA-3 –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    if (dap_sign_init(DAP_SIGN_HASH_TYPE_SHA3) != 0) {
        fprintf(stderr, "Failed to initialize signature system\n");
        return 1;
    }

    // –†–∞–±–æ—Ç–∞ —Å –ø–æ–¥–ø–∏—Å—è–º–∏...
    return 0;
}
```

### –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–¥–ø–∏—Å–µ–π

#### dap_sign_create()
```c
DAP_STATIC_INLINE dap_sign_t *dap_sign_create(dap_enc_key_t *a_key,
                                             const void *a_data,
                                             const size_t a_data_size);
```
**–û–ø–∏—Å–∞–Ω–∏–µ**: –°–æ–∑–¥–∞–µ—Ç —Ü–∏—Ñ—Ä–æ–≤—É—é –ø–æ–¥–ø–∏—Å—å –¥–ª—è –¥–∞–Ω–Ω—ã—Ö.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
- `a_key` - –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á –¥–ª—è –ø–æ–¥–ø–∏—Å–∏
- `a_data` - –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø–æ–¥–ø–∏—Å–∏
- `a_data_size` - —Ä–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç**: –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Å–æ–∑–¥–∞–Ω–Ω—É—é –ø–æ–¥–ø–∏—Å—å –∏–ª–∏ `NULL` –ø—Ä–∏ –æ—à–∏–±–∫–µ

**–ü—Ä–∏–º–µ—Ä**:
```c
#include "dap_sign.h"
#include "dap_enc_key.h"

// –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª—é—á–∞ –¥–ª—è –ø–æ–¥–ø–∏—Å–∏
dap_enc_key_t *key = dap_enc_key_new_generate(DAP_ENC_KEY_TYPE_SIG_DILITHIUM,
                                              NULL, 0, "seed", 4, 0);

const char *message = "Hello, World!";
dap_sign_t *signature = dap_sign_create(key, message, strlen(message));

if (signature) {
    printf("Signature created successfully\n");
    // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ signature...
    free(signature);
} else {
    fprintf(stderr, "Failed to create signature\n");
}
```

#### dap_sign_create_with_hash_type()
```c
dap_sign_t *dap_sign_create_with_hash_type(dap_enc_key_t *a_key,
                                          const void *a_data,
                                          const size_t a_data_size,
                                          uint32_t a_hash_type);
```
**–û–ø–∏—Å–∞–Ω–∏–µ**: –°–æ–∑–¥–∞–µ—Ç –ø–æ–¥–ø–∏—Å—å —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º —Ç–∏–ø–æ–º —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è.

**–ü—Ä–∏–º–µ—Ä**:
```c
// –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∏ —Å Streebog —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º
dap_sign_t *signature = dap_sign_create_with_hash_type(key,
                                                      message, strlen(message),
                                                      DAP_SIGN_HASH_TYPE_STREEBOG);
```

### –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–¥–ø–∏—Å–µ–π

#### dap_sign_verify()
```c
DAP_STATIC_INLINE int dap_sign_verify(dap_sign_t *a_chain_sign,
                                     const void *a_data,
                                     const size_t a_data_size);
```
**–û–ø–∏—Å–∞–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ü–∏—Ñ—Ä–æ–≤—É—é –ø–æ–¥–ø–∏—Å—å.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
- `a_chain_sign` - –ø–æ–¥–ø–∏—Å—å –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
- `a_data` - –ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- `a_data_size` - —Ä–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç**:
- `0` - –ø–æ–¥–ø–∏—Å—å –≤–µ—Ä–Ω–∞
- `-1` - –ø–æ–¥–ø–∏—Å—å –Ω–µ–≤–µ—Ä–Ω–∞
- `-2` - –æ—à–∏–±–∫–∞ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏

**–ü—Ä–∏–º–µ—Ä**:
```c
// –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏
int verify_result = dap_sign_verify(signature, message, strlen(message));

if (verify_result == 0) {
    printf("‚úÖ Signature is valid\n");
} else if (verify_result == -1) {
    printf("‚ùå Signature is invalid\n");
} else {
    printf("‚ö†Ô∏è  Signature verification error\n");
}
```

#### dap_sign_verify_by_pkey()
```c
int dap_sign_verify_by_pkey(dap_sign_t *a_chain_sign,
                           const void *a_data,
                           const size_t a_data_size,
                           dap_pkey_t *a_pkey);
```
**–û–ø–∏—Å–∞–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–ø–∏—Å—å —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∫–ª—é—á–∞.

**–ü—Ä–∏–º–µ—Ä**:
```c
// –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å —è–≤–Ω—ã–º —É–∫–∞–∑–∞–Ω–∏–µ–º –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∫–ª—é—á–∞
dap_pkey_t *public_key = extract_public_key(signature);
int result = dap_sign_verify_by_pkey(signature, message, strlen(message), public_key);
```

#### dap_sign_verify_size()
```c
DAP_STATIC_INLINE int dap_sign_verify_size(dap_sign_t *a_sign,
                                          size_t a_max_sign_size);
```
**–û–ø–∏—Å–∞–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–¥–ø–∏—Å–∏.

**–ü—Ä–∏–º–µ—Ä**:
```c
// –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ –ø–µ—Ä–µ–¥ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–µ–π
if (dap_sign_verify_size(signature, MAX_SIGNATURE_SIZE) == 0) {
    // –†–∞–∑–º–µ—Ä –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π, –º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –ø–æ–¥–ø–∏—Å—å
    dap_sign_verify(signature, data, data_size);
} else {
    fprintf(stderr, "Invalid signature size\n");
}
```

#### dap_sign_verify_all()
```c
DAP_STATIC_INLINE int dap_sign_verify_all(dap_sign_t *a_sign,
                                         const size_t a_sign_size_max,
                                         const void *a_data,
                                         const size_t a_data_size);
```
**–û–ø–∏—Å–∞–Ω–∏–µ**: –ü–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏ (—Ä–∞–∑–º–µ—Ä + –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å).

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç**:
- `0` - –ø–æ–¥–ø–∏—Å—å –≤–µ—Ä–Ω–∞
- `-1` - –ø–æ–¥–ø–∏—Å—å –Ω–µ–≤–µ—Ä–Ω–∞
- `-2` - –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ä–∞–∑–º–µ—Ä

### –†–∞–±–æ—Ç–∞ —Å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏ –ø–æ–¥–ø–∏—Å–∏

#### dap_sign_get_sign()
```c
uint8_t *dap_sign_get_sign(dap_sign_t *a_sign, size_t *a_sign_size);
```
**–û–ø–∏—Å–∞–Ω–∏–µ**: –ò–∑–≤–ª–µ–∫–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∏ –∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã.

**–ü—Ä–∏–º–µ—Ä**:
```c
size_t sig_size;
uint8_t *signature_data = dap_sign_get_sign(signature, &sig_size);

if (signature_data) {
    printf("Signature size: %zu bytes\n", sig_size);
    // –†–∞–±–æ—Ç–∞ —Å signature_data...
}
```

#### dap_sign_get_pkey()
```c
uint8_t *dap_sign_get_pkey(dap_sign_t *a_sign, size_t *a_pub_key_out);
```
**–û–ø–∏—Å–∞–Ω–∏–µ**: –ò–∑–≤–ª–µ–∫–∞–µ—Ç –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –∏–∑ –ø–æ–¥–ø–∏—Å–∏.

**–ü—Ä–∏–º–µ—Ä**:
```c
size_t pkey_size;
uint8_t *public_key = dap_sign_get_pkey(signature, &pkey_size);

if (public_key) {
    printf("Public key size: %zu bytes\n", pkey_size);
    // –†–∞–±–æ—Ç–∞ —Å public_key...
}
```

#### dap_sign_get_pkey_hash()
```c
bool dap_sign_get_pkey_hash(dap_sign_t *a_sign, dap_chain_hash_fast_t *a_sign_hash);
```
**–û–ø–∏—Å–∞–Ω–∏–µ**: –í—ã—á–∏—Å–ª—è–µ—Ç —Ö—ç—à –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∫–ª—é—á–∞ –∏–∑ –ø–æ–¥–ø–∏—Å–∏.

**–ü—Ä–∏–º–µ—Ä**:
```c
dap_chain_hash_fast_t pkey_hash;
if (dap_sign_get_pkey_hash(signature, &pkey_hash)) {
    char hash_str[DAP_CHAIN_HASH_FAST_STR_SIZE];
    dap_chain_hash_fast_to_str(&pkey_hash, hash_str, sizeof(hash_str));
    printf("Public key hash: %s\n", hash_str);
}
```

### –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —Ç–∏–ø–æ–≤

#### dap_sign_type_from_key_type()
```c
dap_sign_type_t dap_sign_type_from_key_type(dap_enc_key_type_t a_key_type);
```
**–û–ø–∏—Å–∞–Ω–∏–µ**: –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç —Ç–∏–ø –∫–ª—é—á–∞ –≤ —Ç–∏–ø –ø–æ–¥–ø–∏—Å–∏.

**–ü—Ä–∏–º–µ—Ä**:
```c
dap_enc_key_type_t key_type = DAP_ENC_KEY_TYPE_SIG_DILITHIUM;
dap_sign_type_t sign_type = dap_sign_type_from_key_type(key_type);
// sign_type.type —Ç–µ–ø–µ—Ä—å —Å–æ–¥–µ—Ä–∂–∏—Ç SIG_TYPE_DILITHIUM
```

#### dap_sign_type_to_key_type()
```c
dap_enc_key_type_t dap_sign_type_to_key_type(dap_sign_type_t a_chain_sign_type);
```
**–û–ø–∏—Å–∞–Ω–∏–µ**: –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç —Ç–∏–ø –ø–æ–¥–ø–∏—Å–∏ –≤ —Ç–∏–ø –∫–ª—é—á–∞.

### –°—Ç—Ä–æ–∫–æ–≤—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è

#### dap_sign_type_to_str()
```c
const char *dap_sign_type_to_str(dap_sign_type_t a_chain_sign_type);
```
**–û–ø–∏—Å–∞–Ω–∏–µ**: –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç —Ç–∏–ø –ø–æ–¥–ø–∏—Å–∏ –≤ —Å—Ç—Ä–æ–∫—É.

**–ü—Ä–∏–º–µ—Ä**:
```c
dap_sign_type_t sign_type = { .type = SIG_TYPE_DILITHIUM };
const char *type_str = dap_sign_type_to_str(sign_type);
printf("Signature type: %s\n", type_str); // "SIG_TYPE_DILITHIUM"
```

#### dap_sign_type_from_str()
```c
dap_sign_type_t dap_sign_type_from_str(const char *a_type_str);
```
**–û–ø–∏—Å–∞–Ω–∏–µ**: –ü–∞—Ä—Å–∏—Ç —Ç–∏–ø –ø–æ–¥–ø–∏—Å–∏ –∏–∑ —Å—Ç—Ä–æ–∫–∏.

**–ü—Ä–∏–º–µ—Ä**:
```c
dap_sign_type_t sign_type = dap_sign_type_from_str("SIG_TYPE_FALCON");
// sign_type.type —Ç–µ–ø–µ—Ä—å —Å–æ–¥–µ—Ä–∂–∏—Ç SIG_TYPE_FALCON
```

### –†–∞–±–æ—Ç–∞ —Å –∫–ª—é—á–∞–º–∏

#### dap_sign_to_enc_key()
```c
DAP_STATIC_INLINE dap_enc_key_t *dap_sign_to_enc_key(dap_sign_t *a_chain_sign);
```
**–û–ø–∏—Å–∞–Ω–∏–µ**: –°–æ–∑–¥–∞–µ—Ç –æ–±—ä–µ–∫—Ç –∫–ª—é—á–∞ –∏–∑ –ø–æ–¥–ø–∏—Å–∏.

**–ü—Ä–∏–º–µ—Ä**:
```c
dap_enc_key_t *key = dap_sign_to_enc_key(signature);
if (key) {
    printf("Key type: %s\n", dap_enc_get_type_name(key->type));
    // –†–∞–±–æ—Ç–∞ —Å key...
    dap_enc_key_delete(key);
}
```

#### dap_sign_to_enc_key_by_pkey()
```c
dap_enc_key_t *dap_sign_to_enc_key_by_pkey(dap_sign_t *a_chain_sign,
                                          dap_pkey_t *a_pkey);
```
**–û–ø–∏—Å–∞–Ω–∏–µ**: –°–æ–∑–¥–∞–µ—Ç –∫–ª—é—á –∏–∑ –ø–æ–¥–ø–∏—Å–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –≤–Ω–µ—à–Ω–µ–≥–æ –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∫–ª—é—á–∞.

### –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

#### dap_sign_get_information()
```c
void dap_sign_get_information(dap_sign_t *a_sign,
                             dap_string_t *a_str_out,
                             const char *a_hash_out_type);
```
**–û–ø–∏—Å–∞–Ω–∏–µ**: –ü–æ–ª—É—á–∞–µ—Ç —Ç–µ–∫—Å—Ç–æ–≤—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–¥–ø–∏—Å–∏.

**–ü—Ä–∏–º–µ—Ä**:
```c
dap_string_t info;
dap_sign_get_information(signature, &info, "hex");
printf("Signature info:\n%s\n", info.s);
dap_string_free(&info);
```

#### dap_sign_get_information_json()
```c
void dap_sign_get_information_json(json_object *a_json_arr_reply,
                                  dap_sign_t *a_sign,
                                  json_object *a_json_out,
                                  const char *a_hash_out_type,
                                  int a_version);
```
**–û–ø–∏—Å–∞–Ω–∏–µ**: –ü–æ–ª—É—á–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–¥–ø–∏—Å–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON.

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–µ–π

#### dap_sign_compare_pkeys()
```c
bool dap_sign_compare_pkeys(dap_sign_t *l_sign1, dap_sign_t *l_sign2);
```
**–û–ø–∏—Å–∞–Ω–∏–µ**: –°—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç –ø—É–±–ª–∏—á–Ω—ã–µ –∫–ª—é—á–∏ –¥–≤—É—Ö –ø–æ–¥–ø–∏—Å–µ–π.

**–ü—Ä–∏–º–µ—Ä**:
```c
if (dap_sign_compare_pkeys(signature1, signature2)) {
    printf("Signatures have the same public key\n");
} else {
    printf("Signatures have different public keys\n");
}
```

### –£—Ç–∏–ª–∏—Ç–∞—Ä–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

#### dap_sign_get_size()
```c
uint64_t dap_sign_get_size(dap_sign_t *a_chain_sign);
```
**–û–ø–∏—Å–∞–Ω–∏–µ**: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ–ª–Ω—ã–π —Ä–∞–∑–º–µ—Ä –ø–æ–¥–ø–∏—Å–∏ –≤ –±–∞–π—Ç–∞—Ö.

#### dap_sign_type_is_depricated()
```c
bool dap_sign_type_is_depricated(dap_sign_type_t a_sign_type);
```
**–û–ø–∏—Å–∞–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Ç–∏–ø –ø–æ–¥–ø–∏—Å–∏ —É—Å—Ç–∞—Ä–µ–≤—à–∏–º.

#### dap_sign_get_str_recommended_types()
```c
const char *dap_sign_get_str_recommended_types();
```
**–û–ø–∏—Å–∞–Ω–∏–µ**: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç—Ä–æ–∫—É —Å —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–º–∏ —Ç–∏–ø–∞–º–∏ –ø–æ–¥–ø–∏—Å–µ–π.

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –ë–∞–∑–æ–≤–∞—è –ø–æ–¥–ø–∏—Å—å –∏ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è

```c
#include "dap_sign.h"
#include "dap_enc_key.h"

int basic_sign_verify_example() {
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    if (dap_sign_init(DAP_SIGN_HASH_TYPE_SHA3) != 0) {
        return -1;
    }

    // –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª—é—á–∞ –¥–ª—è Dilithium –ø–æ–¥–ø–∏—Å–∏
    dap_enc_key_t *key = dap_enc_key_new_generate(DAP_ENC_KEY_TYPE_SIG_DILITHIUM,
                                                  NULL, 0,
                                                  "secure_seed", 11,
                                                  0);

    if (!key) {
        fprintf(stderr, "Failed to generate key\n");
        return -1;
    }

    // –î–∞–Ω–Ω—ã–µ –¥–ª—è –ø–æ–¥–ø–∏—Å–∏
    const char *message = "This is a test message for post-quantum signature";
    size_t message_len = strlen(message);

    // –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∏
    dap_sign_t *signature = dap_sign_create(key, message, message_len);

    if (!signature) {
        fprintf(stderr, "Failed to create signature\n");
        dap_enc_key_delete(key);
        return -1;
    }

    // –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–¥–ø–∏—Å–∏
    int verify_result = dap_sign_verify(signature, message, message_len);

    if (verify_result == 0) {
        printf("‚úÖ Post-quantum signature verified successfully!\n");
        printf("Algorithm: Dilithium (NIST finalist)\n");
        printf("Security level: 128-bit against quantum attacks\n");
    } else {
        printf("‚ùå Signature verification failed\n");
    }

    // –û—á–∏—Å—Ç–∫–∞
    // –û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ signature –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–æ–≥–æ, –∫–∞–∫ –æ–Ω–∞ –±—ã–ª–∞ —Å–æ–∑–¥–∞–Ω–∞
    dap_enc_key_delete(key);

    return verify_result == 0 ? 0 : -1;
}
```

### –ü—Ä–∏–º–µ—Ä 2: –†–∞–±–æ—Ç–∞ —Å —Ä–∞–∑–Ω—ã–º–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞–º–∏ –ø–æ–¥–ø–∏—Å–µ–π

```c
#include "dap_sign.h"
#include "dap_enc_key.h"

typedef struct {
    dap_enc_key_type_t key_type;
    const char *description;
} signature_test_t;

int test_multiple_signatures() {
    signature_test_t tests[] = {
        {DAP_ENC_KEY_TYPE_SIG_DILITHIUM, "Dilithium (Post-quantum, NIST finalist)"},
        {DAP_ENC_KEY_TYPE_SIG_FALCON, "Falcon (Post-quantum, NIST finalist)"},
        {DAP_ENC_KEY_TYPE_SIG_ECDSA, "ECDSA (Classical, secp256r1)"},
        {DAP_ENC_KEY_TYPE_SIG_BLISS, "BLISS (Lattice-based)"}
    };

    const char *test_data = "Multi-signature test data";
    size_t data_size = strlen(test_data);

    for (size_t i = 0; i < sizeof(tests) / sizeof(tests[0]); i++) {
        printf("\n--- Testing %s ---\n", tests[i].description);

        // –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª—é—á–∞
        dap_enc_key_t *key = dap_enc_key_new_generate(tests[i].key_type,
                                                      NULL, 0,
                                                      "test_seed", 9,
                                                      0);

        if (!key) {
            printf("‚ùå Failed to generate key for %s\n", tests[i].description);
            continue;
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∏
        dap_sign_t *signature = dap_sign_create(key, test_data, data_size);

        if (!signature) {
            printf("‚ùå Failed to create signature for %s\n", tests[i].description);
            dap_enc_key_delete(key);
            continue;
        }

        // –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è
        int verify_result = dap_sign_verify(signature, test_data, data_size);

        if (verify_result == 0) {
            // –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–¥–ø–∏—Å–∏
            dap_string_t info;
            dap_sign_get_information(signature, &info, "hex");

            printf("‚úÖ %s signature successful\n", tests[i].description);
            printf("Signature info: %s\n", info.s);

            dap_string_free(&info);
        } else {
            printf("‚ùå %s signature verification failed\n", tests[i].description);
        }

        // –û—á–∏—Å—Ç–∫–∞
        dap_enc_key_delete(key);
        // signature –Ω—É–∂–Ω–æ –æ—Å–≤–æ–±–æ–¥–∏—Ç—å –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
    }

    return 0;
}
```

### –ü—Ä–∏–º–µ—Ä 3: –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–µ–π

```c
#include "dap_sign.h"
#include "dap_enc_key.h"

int signature_storage_example() {
    // –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∏
    dap_enc_key_t *key = dap_enc_key_new_generate(DAP_ENC_KEY_TYPE_SIG_DILITHIUM,
                                                  NULL, 0,
                                                  "storage_test", 12,
                                                  0);

    const char *data = "Data to be signed and stored";
    dap_sign_t *signature = dap_sign_create(key, data, strlen(data));

    if (!signature) {
        dap_enc_key_delete(key);
        return -1;
    }

    // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–¥–ø–∏—Å–∏
    uint64_t signature_size = dap_sign_get_size(signature);
    printf("Signature total size: %" PRIu64 " bytes\n", signature_size);

    // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∏ –≤ —Ñ–∞–π–ª
    FILE *file = fopen("signature.bin", "wb");
    if (file) {
        size_t written = fwrite(signature, 1, signature_size, file);
        fclose(file);

        if (written == signature_size) {
            printf("‚úÖ Signature saved to file\n");
        } else {
            printf("‚ùå Failed to save signature\n");
        }
    }

    // –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–¥–ø–∏—Å–∏ –∏–∑ —Ñ–∞–π–ª–∞
    FILE *read_file = fopen("signature.bin", "rb");
    if (read_file) {
        // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–∞
        fseek(read_file, 0, SEEK_END);
        size_t file_size = ftell(read_file);
        fseek(read_file, 0, SEEK_SET);

        // –ß—Ç–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∏
        dap_sign_t *loaded_signature = malloc(file_size);
        if (fread(loaded_signature, 1, file_size, read_file) == file_size) {
            fclose(read_file);

            // –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–π –ø–æ–¥–ø–∏—Å–∏
            int verify_result = dap_sign_verify(loaded_signature, data, strlen(data));

            if (verify_result == 0) {
                printf("‚úÖ Loaded signature verified successfully\n");

                // –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–¥–ø–∏—Å–∏
                dap_string_t info;
                dap_sign_get_information(loaded_signature, &info, "hex");
                printf("Signature details:\n%s\n", info.s);
                dap_string_free(&info);

            } else {
                printf("‚ùå Loaded signature verification failed\n");
            }

            free(loaded_signature);
        } else {
            fclose(read_file);
            printf("‚ùå Failed to read signature from file\n");
        }
    }

    dap_enc_key_delete(key);
    return 0;
}
```

### –ü—Ä–∏–º–µ—Ä 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏ —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏

```c
#include "dap_sign.h"

int secure_signature_verification(dap_sign_t *signature,
                                 const void *data,
                                 size_t data_size,
                                 size_t max_signature_size) {
    if (!signature || !data || data_size == 0) {
        fprintf(stderr, "Invalid parameters\n");
        return -1;
    }

    // –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–¥–ø–∏—Å–∏
    if (dap_sign_verify_size(signature, max_signature_size) != 0) {
        fprintf(stderr, "Signature size verification failed\n");
        return -2;
    }

    // –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–∞ –ø–æ–¥–ø–∏—Å–∏
    if (signature->header.type.type == SIG_TYPE_NULL) {
        fprintf(stderr, "Null signature type not allowed\n");
        return -3;
    }

    // –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —É—Å—Ç–∞—Ä–µ–≤—à–∏–π —Ç–∏–ø
    if (dap_sign_type_is_depricated(signature->header.type)) {
        fprintf(stderr, "Deprecated signature type detected\n");
        return -4;
    }

    // –®–∞–≥ 4: –û—Å–Ω–æ–≤–Ω–∞—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è
    int verify_result = dap_sign_verify(signature, data, data_size);

    if (verify_result == 0) {
        printf("‚úÖ Signature verification successful\n");

        // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
        const char *type_str = dap_sign_type_to_str(signature->header.type);
        printf("Signature type: %s\n", type_str);

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ö—ç—à–∞ –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∫–ª—é—á–∞
        if (dap_sign_is_use_pkey_hash(signature)) {
            printf("Public key hash is used for verification\n");
        }

        return 0;
    } else if (verify_result == -1) {
        fprintf(stderr, "‚ùå Signature is invalid\n");
        return -5;
    } else {
        fprintf(stderr, "‚ö†Ô∏è  Signature verification error\n");
        return -6;
    }
}

int comprehensive_verification_example() {
    // –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∏
    dap_enc_key_t *key = dap_enc_key_new_generate(DAP_ENC_KEY_TYPE_SIG_FALCON,
                                                  NULL, 0,
                                                  "verify_test", 11,
                                                  0);

    const char *test_data = "Comprehensive verification test";
    dap_sign_t *signature = dap_sign_create(key, test_data, strlen(test_data));

    if (signature) {
        // –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è
        int result = secure_signature_verification(signature,
                                                  test_data, strlen(test_data),
                                                  1024 * 1024); // 1MB max

        if (result == 0) {
            printf("üéâ All verification checks passed!\n");
        }

        dap_enc_key_delete(key);
        return result;
    }

    dap_enc_key_delete(key);
    return -1;
}
```

### –ü—Ä–∏–º–µ—Ä 5: –†–∞–±–æ—Ç–∞ —Å –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—ã–º–∏ –ø–æ–¥–ø–∏—Å—è–º–∏

```c
#include "dap_sign.h"
#include "dap_enc_key.h"

int multi_signature_example() {
    // –°–æ–∑–¥–∞–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∫–ª—é—á–µ–π –¥–ª—è –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–æ–π –ø–æ–¥–ø–∏—Å–∏
    dap_enc_key_t *keys[3];

    keys[0] = dap_enc_key_new_generate(DAP_ENC_KEY_TYPE_SIG_DILITHIUM, NULL, 0, "key1", 4, 0);
    keys[1] = dap_enc_key_new_generate(DAP_ENC_KEY_TYPE_SIG_FALCON, NULL, 0, "key2", 4, 0);
    keys[2] = dap_enc_key_new_generate(DAP_ENC_KEY_TYPE_SIG_ECDSA, NULL, 0, "key3", 4, 0);

    if (!keys[0] || !keys[1] || !keys[2]) {
        fprintf(stderr, "Failed to generate keys\n");
        // –û—á–∏—Å—Ç–∫–∞ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –∫–ª—é—á–µ–π
        for (int i = 0; i < 3; i++) {
            if (keys[i]) dap_enc_key_delete(keys[i]);
        }
        return -1;
    }

    const char *data = "Multi-signature test data";
    size_t data_size = strlen(data);

    // –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–¥–ø–∏—Å–µ–π –∫–∞–∂–¥—ã–º –∫–ª—é—á–æ–º
    dap_sign_t *signatures[3];
    for (int i = 0; i < 3; i++) {
        signatures[i] = dap_sign_create(keys[i], data, data_size);
        if (!signatures[i]) {
            fprintf(stderr, "Failed to create signature %d\n", i);
            // –û—á–∏—Å—Ç–∫–∞
            for (int j = 0; j < 3; j++) {
                if (keys[j]) dap_enc_key_delete(keys[j]);
                // signatures[j] –Ω—É–∂–Ω–æ –æ—Å–≤–æ–±–æ–¥–∏—Ç—å
            }
            return -1;
        }
    }

    // –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –∫–∞–∂–¥–æ–π –ø–æ–¥–ø–∏—Å–∏
    const char *alg_names[] = {"Dilithium", "Falcon", "ECDSA"};

    for (int i = 0; i < 3; i++) {
        int verify_result = dap_sign_verify(signatures[i], data, data_size);

        if (verify_result == 0) {
            printf("‚úÖ %s signature verified\n", alg_names[i]);

            // –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–¥–ø–∏—Å–∏
            uint64_t sig_size = dap_sign_get_size(signatures[i]);
            printf("   Signature size: %" PRIu64 " bytes\n", sig_size);

        } else {
            printf("‚ùå %s signature verification failed\n", alg_names[i]);
        }
    }

    printf("\nüìä Multi-signature Summary:\n");
    printf("- Total signatures: 3\n");
    printf("- Algorithms: Dilithium (PQ), Falcon (PQ), ECDSA (Classical)\n");
    printf("- Combined security: Post-quantum + Classical protection\n");

    // –û—á–∏—Å—Ç–∫–∞
    for (int i = 0; i < 3; i++) {
        dap_enc_key_delete(keys[i]);
        // signatures[i] –Ω—É–∂–Ω–æ –æ—Å–≤–æ–±–æ–¥–∏—Ç—å –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
    }

    return 0;
}
```

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –í—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–¥–ø–∏—Å–µ–π

| –ê–ª–≥–æ—Ä–∏—Ç–º | –í—Ä–µ–º—è –ø–æ–¥–ø–∏—Å–∏ | –í—Ä–µ–º—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ | –†–∞–∑–º–µ—Ä –ø–æ–¥–ø–∏—Å–∏ |
|----------|----------------|-------------------|----------------|
| Dilithium | ~50 Œºs | ~25 Œºs | 2,420 bytes |
| Falcon | ~100 Œºs | ~15 Œºs | 690 bytes |
| ECDSA | ~20 Œºs | ~40 Œºs | 64 bytes |
| BLISS | ~30 Œºs | ~20 Œºs | 1,200 bytes |

### –í—Ä–µ–º—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ–¥–ø–∏—Å–µ–π

| –ê–ª–≥–æ—Ä–∏—Ç–º | –í—Ä–µ–º—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ | CPU –Ω–∞–≥—Ä—É–∑–∫–∞ |
|----------|-------------------|--------------|
| Dilithium | ~25 Œºs | –°—Ä–µ–¥–Ω—è—è |
| Falcon | ~15 Œºs | –ù–∏–∑–∫–∞—è |
| ECDSA | ~40 Œºs | –ù–∏–∑–∫–∞—è |
| BLISS | ~20 Œºs | –°—Ä–µ–¥–Ω—è—è |

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –£—Ä–æ–≤–Ω–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤

#### –ü–æ—Å—Ç-–∫–≤–∞–Ω—Ç–æ–≤—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã (—Ä–µ–∫–æ–º–µ–Ω–¥—É—é—Ç—Å—è):
- **Dilithium**: 128/192/256-bit –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø—Ä–æ—Ç–∏–≤ –∫–≤–∞–Ω—Ç–æ–≤—ã—Ö –∞—Ç–∞–∫
- **Falcon**: 128/192/256-bit –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- **Sphincs+**: 128/192/256-bit –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (stateful)

#### –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã:
- **ECDSA**: 128-bit –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (—É—è–∑–≤–∏–º –∫ –∫–≤–∞–Ω—Ç–æ–≤—ã–º –∞—Ç–∞–∫–∞–º)
- **BLISS**: 128-bit –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (Lattice-based)
- **TESLA**: –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –≤—ã–±–æ—Ä—É –∞–ª–≥–æ—Ä–∏—Ç–º–∞

#### –î–ª—è –Ω–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):
```c
// –ü–æ—Å—Ç-–∫–≤–∞–Ω—Ç–æ–≤—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã (–±—É–¥—É—â–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)
dap_enc_key_t *key = dap_enc_key_new_generate(DAP_ENC_KEY_TYPE_SIG_DILITHIUM, ...);
// –∏–ª–∏
dap_enc_key_t *key = dap_enc_key_new_generate(DAP_ENC_KEY_TYPE_SIG_FALCON, ...);
```

#### –î–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:
```c
// –ë—ã—Å—Ç—Ä—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã
dap_enc_key_t *key = dap_enc_key_new_generate(DAP_ENC_KEY_TYPE_SIG_FALCON, ...); // –°–∞–º—ã–π –±—ã—Å—Ç—Ä—ã–π
// –∏–ª–∏
dap_enc_key_t *key = dap_enc_key_new_generate(DAP_ENC_KEY_TYPE_SIG_BLISS, ...);
```

#### –î–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏:
```c
// –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã
dap_enc_key_t *key = dap_enc_key_new_generate(DAP_ENC_KEY_TYPE_SIG_ECDSA, ...);
```

### –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è –∑–∞—â–∏—Ç–∞

```c
// –°–æ–∑–¥–∞–Ω–∏–µ –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–æ–π –ø–æ–¥–ø–∏—Å–∏
void create_multi_level_signature(const void *data, size_t data_size) {
    // –£—Ä–æ–≤–µ–Ω—å 1: –ü–æ—Å—Ç-–∫–≤–∞–Ω—Ç–æ–≤–∞—è –ø–æ–¥–ø–∏—Å—å (–∑–∞—â–∏—Ç–∞ –æ—Ç –∫–≤–∞–Ω—Ç–æ–≤—ã—Ö –∞—Ç–∞–∫)
    dap_enc_key_t *pq_key = dap_enc_key_new_generate(DAP_ENC_KEY_TYPE_SIG_DILITHIUM, ...);
    dap_sign_t *pq_signature = dap_sign_create(pq_key, data, data_size);

    // –£—Ä–æ–≤–µ–Ω—å 2: –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –ø–æ–¥–ø–∏—Å—å (—Ç–µ–∫—É—â–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å)
    dap_enc_key_t *classic_key = dap_enc_key_new_generate(DAP_ENC_KEY_TYPE_SIG_ECDSA, ...);
    dap_sign_t *classic_signature = dap_sign_create(classic_key, data, data_size);

    // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ–±–µ–∏—Ö –ø–æ–¥–ø–∏—Å–µ–π
    // ...
}
```

## –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

### 1. –í—ã–±–æ—Ä –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –ø–æ–¥–ø–∏—Å–∏

```c
// –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤—ã–±–æ—Ä –∞–ª–≥–æ—Ä–∏—Ç–º–∞
dap_enc_key_type_t select_signature_algorithm(bool need_quantum_resistance,
                                            bool need_high_speed,
                                            bool need_compact_size) {
    if (need_quantum_resistance) {
        if (need_high_speed) {
            return DAP_ENC_KEY_TYPE_SIG_FALCON;  // –ë—ã—Å—Ç—Ä—ã–π + PQ
        } else if (need_compact_size) {
            return DAP_ENC_KEY_TYPE_SIG_FALCON;  // –ö–æ–º–ø–∞–∫—Ç–Ω—ã–π + PQ
        } else {
            return DAP_ENC_KEY_TYPE_SIG_DILITHIUM; // –°—Ç–∞–Ω–¥–∞—Ä—Ç PQ
        }
    } else {
        if (need_high_speed) {
            return DAP_ENC_KEY_TYPE_SIG_ECDSA;   // –ë—ã—Å—Ç—Ä—ã–π –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π
        } else {
            return DAP_ENC_KEY_TYPE_SIG_BLISS;   // Lattice-based
        }
    }
}
```

### 2. –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è

```c
// –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏
int secure_verify_signature(dap_sign_t *signature,
                           const void *data, size_t data_size,
                           size_t max_size) {
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ö–æ–¥–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
    if (!signature || !data || data_size == 0) {
        return -1;
    }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞
    if (dap_sign_verify_size(signature, max_size) != 0) {
        return -2;
    }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–∞
    if (signature->header.type.type == SIG_TYPE_NULL) {
        return -3;
    }

    // –û—Å–Ω–æ–≤–Ω–∞—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è
    return dap_sign_verify(signature, data, data_size);
}
```

### 3. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª—é—á–∞–º–∏ –ø–æ–¥–ø–∏—Å–∏

```c
// –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª—é—á–∞–º–∏
typedef struct signature_context {
    dap_enc_key_t *signing_key;
    dap_enc_key_t *verification_key;
    time_t key_created;
    time_t key_expires;
} signature_context_t;

signature_context_t *create_signature_context(dap_enc_key_type_t key_type) {
    signature_context_t *ctx = calloc(1, sizeof(signature_context_t));

    if (!ctx) return NULL;

    // –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª—é—á–∞ –¥–ª—è –ø–æ–¥–ø–∏—Å–∏
    ctx->signing_key = dap_enc_key_new_generate(key_type,
                                               NULL, 0,
                                               "signing_key_seed", 15,
                                               0);

    if (!ctx->signing_key) {
        free(ctx);
        return NULL;
    }

    // –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª—é—á–∞ –¥–ª—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ (—Å —Ç–µ–º –∂–µ –ø—É–±–ª–∏—á–Ω—ã–º –∫–ª—é—á–æ–º)
    ctx->verification_key = dap_sign_to_enc_key(ctx->signing_key);

    ctx->key_created = time(NULL);
    ctx->key_expires = ctx->key_created + (365 * 24 * 60 * 60); // 1 –≥–æ–¥

    return ctx;
}

void destroy_signature_context(signature_context_t *ctx) {
    if (ctx) {
        if (ctx->signing_key) dap_enc_key_delete(ctx->signing_key);
        if (ctx->verification_key) dap_enc_key_delete(ctx->verification_key);
        free(ctx);
    }
}
```

### 4. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

```c
// –ù–∞–¥–µ–∂–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –ø–æ–¥–ø–∏—Å—è–º–∏
dap_sign_t *create_signature_safe(dap_enc_key_t *key,
                                 const void *data, size_t data_size,
                                 const char **error_msg) {
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
    if (!key || !data || data_size == 0) {
        *error_msg = "Invalid parameters";
        return NULL;
    }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–∞ –∫–ª—é—á–∞
    if (key->type < DAP_ENC_KEY_TYPE_SIG_BLISS ||
        key->type > DAP_ENC_KEY_TYPE_SIG_SHIPOVNIK) {
        *error_msg = "Key is not suitable for signing";
        return NULL;
    }

    // –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∏
    dap_sign_t *signature = dap_sign_create(key, data, data_size);

    if (!signature) {
        *error_msg = "Failed to create signature";
        return NULL;
    }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–∑–¥–∞–Ω–Ω–æ–π –ø–æ–¥–ø–∏—Å–∏
    if (dap_sign_verify_size(signature, 1024 * 1024) != 0) {
        *error_msg = "Created signature has invalid size";
        // signature –Ω—É–∂–Ω–æ –æ—Å–≤–æ–±–æ–¥–∏—Ç—å
        return NULL;
    }

    *error_msg = NULL;
    return signature;
}
```

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ú–æ–¥—É–ª—å `dap_sign` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –º–æ—â–Ω—É—é –∏ –≥–∏–±–∫—É—é —Å–∏—Å—Ç–µ–º—É —Ü–∏—Ñ—Ä–æ–≤—ã—Ö –ø–æ–¥–ø–∏—Å–µ–π:

### –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:
- **–ü–æ—Å—Ç-–∫–≤–∞–Ω—Ç–æ–≤–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤
- **–í—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- **–ì–∏–±–∫–æ—Å—Ç—å**: –ú–Ω–æ–∂–µ—Å—Ç–≤–æ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –Ω–∞ –≤—ã–±–æ—Ä
- **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å**: –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏

### –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ 10+ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –ø–æ–¥–ø–∏—Å–µ–π
- –ü–æ—Å—Ç-–∫–≤–∞–Ω—Ç–æ–≤–∞—è –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—è (Dilithium, Falcon, Sphincs+)
- –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã (ECDSA, BLISS)
- –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∏ (Ring signatures, Multisign)
- –ü–æ–ª–Ω–∞—è —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏ –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é:
1. **–î–ª—è –Ω–æ–≤—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ—Å—Ç-–∫–≤–∞–Ω—Ç–æ–≤—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã (Dilithium/Falcon)
2. **–î–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏**: –í—ã–±–∏—Ä–∞–π—Ç–µ Falcon (—Å–∞–º—ã–π –±—ã—Å—Ç—Ä—ã–π)
3. **–î–ª—è —Ä–∞–∑–º–µ—Ä–∞**: –£—á–∏—Ç—ã–≤–∞–π—Ç–µ —Ä–∞–∑–º–µ—Ä –ø–æ–¥–ø–∏—Å–µ–π (ECDSA - —Å–∞–º—ã–π –∫–æ–º–ø–∞–∫—Ç–Ω—ã–π)
4. **–í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ** —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–ø–µ—Ä–∞—Ü–∏–π —Å –ø–æ–¥–ø–∏—Å—è–º–∏
5. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–ø–ª–µ–∫—Å–Ω—É—é –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é** (—Ä–∞–∑–º–µ—Ä + –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å + —Ç–∏–ø)

### –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:
1. –ò–∑—É—á–∏—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –≤ —Ä–∞–∑–¥–µ–ª–∞—Ö –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
2. –û–∑–Ω–∞–∫–æ–º—å—Ç–µ—Å—å —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
3. –í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º –¥–ª—è –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
4. –†–µ–∞–ª–∏–∑—É–π—Ç–µ —Å–∏—Å—Ç–µ–º—É –ø–æ–¥–ø–∏—Å–µ–π –≤ –≤–∞—à–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
5. –°–ª–µ–¥–∏—Ç–µ –∑–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–≤

–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ —Å–º–æ—Ç—Ä–∏—Ç–µ:
- `dap_sign.h` - –ø–æ–ª–Ω—ã–π API –ø–æ–¥–ø–∏—Å–µ–π
- `dap_enc_key.h` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª—é—á–∞–º–∏
- `dap_hash.h` - —Ö—ç—à-—Ñ—É–Ω–∫—Ü–∏–∏
- –ü—Ä–∏–º–µ—Ä—ã –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `examples/crypto/`
- –¢–µ—Å—Ç—ã –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `test/crypto/`
