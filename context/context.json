{
  "version": "1.5",
  "created": "2025-01-03T15:00:00Z",
  "updated": "2025-06-06T13:30:00Z",
  "project": {
    "name": "DAP SDK",
    "description": "Cellframe DAP SDK - blockchain development framework with post-quantum cryptography",
    "version": "latest",
    "status": "active_development",
    "primary_languages": ["C", "C++"],
    "architecture": "modular",
    "key_features": [
      "Post-quantum cryptography (Chipmunk signatures, Kyber KEM, MSRLN)",
      "Cross-platform support (Linux, macOS, Windows)",
      "Enhanced logging system with multiple levels",
      "Comprehensive test framework",
      "CMake build system with multiple configurations"
    ],
    "build_configurations": {
      "debug": "build_debug/ - Debug build with symbols and assertions",
      "release": "build.release/ - Optimized release build", 
      "test": "build_test/ - Test configuration",
      "ci": "build_ci/ - CI/CD pipeline build",
      "asan": "build_asan/ - AddressSanitizer build for memory debugging"
    }
  },
  "recent_achievements": {
    "2025-06-06": {
      "milestone": "Chipmunk Post-Quantum Signature Implementation COMPLETED + Infrastructure Improvements",
      "achievement": "100% working Chipmunk implementation + Enhanced logging system + Fixed core tests",
      "impact": "Production-ready post-quantum cryptography + improved development experience",
      "status": "COMPLETED - Ready for production use and advanced integration"
    }
  },
  "current_focus": {
    "area": "Advanced post-quantum cryptography integration and production features",
    "status": "Infrastructure improvements completed, moving to dap_sign integration",
    "next_priorities": [
      "Chipmunk integration into dap_sign module",
      "Aggregated signatures implementation", 
      "Batch verification optimization",
      "Production feature enhancements"
    ]
  },
  "core_modules": {
    "crypto": {
      "status": "production_ready_plus",
      "latest_completion": "Chipmunk post-quantum signatures fully integrated + ready for dap_sign",
      "reference": "context/modules/crypto.json",
      "load_policy": "on_demand"
    },
    "core": {
      "status": "enhanced",
      "latest_improvements": "New logging system + fixed test suite compatibility",
      "reference": "context/modules/core.json",
      "load_policy": "on_demand"
    },
    "net": {
      "status": "stable", 
      "reference": "context/modules/net.json",
      "load_policy": "on_demand"
    },
    "other": {
      "status": "stable",
      "reference": "context/modules/other.json",
      "load_policy": "on_demand"
    }
  },
  "build_system": {
    "primary": "CMake",
    "environments": {
      "debug": "build_debug/",
      "release": "build.release/",
      "asan": "build_asan/"
    },
    "status": "fully_functional",
    "test_suites": ["crypto-test", "core-test", "net-test"],
    "recent_fixes": [
      "macOS/Clang compatibility for core tests",
      "Fixed __builtin_*_overflow_p issues",
      "Enhanced test framework integration"
    ]
  },
  "quality_standards": {
    "coding_guidelines": "context/coding_guidelines.json",
    "project_standards": "context/project_standards.json",
    "code_templates": "context/code_templates.json",
    "testing_guidelines": "context/testing_guidelines.json",
    "load_policy": "auto_load"
  },
  "testing_framework": {
    "primary": "Custom DAP test framework (test-framework/)",
    "logging_integration": "Enhanced with new logging system",
    "guidelines": {
      "unit_test_logging": {
        "format": "DAP_LOG_FORMAT_NO_PREFIX",
        "rule": "–í–°–ï–ì–î–ê –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ NO_PREFIX —Ñ–æ—Ä–º–∞—Ç –¥–ª—è —á–∏—Å—Ç–æ–≥–æ –≤—ã–≤–æ–¥–∞ –≤ unit —Ç–µ—Å—Ç–∞—Ö",
        "setup_function": "dap_log_set_format(DAP_LOG_FORMAT_NO_PREFIX)",
        "rationale": "–û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —á–∏—Ç–∞–µ–º—ã–π –≤—ã–≤–æ–¥ –±–µ–∑ –ª–∏—à–Ω–∏—Ö –ø—Ä–µ—Ñ–∏–∫—Å–æ–≤ –≤—Ä–µ–º–µ–Ω–∏/–º–æ–¥—É–ª–µ–π"
      },
      "test_structure": {
        "initialization": "–í—Å–µ–≥–¥–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Å–∏—Å—Ç–µ–º—É –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –Ω–∞—á–∞–ª–µ —Ç–µ—Å—Ç–æ–≤",
        "cleanup": "–í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π—Ç–µ –∏—Å—Ö–æ–¥–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–æ–≤",
        "output_target": "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ LOGGER_OUTPUT_STDOUT –¥–ª—è –∫–æ–Ω—Å–æ–ª—å–Ω–æ–≥–æ –≤—ã–≤–æ–¥–∞ —Ç–µ—Å—Ç–æ–≤"
      },
      "assertion_style": "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ dap_assert() —Å –æ–ø–∏—Å–∞—Ç–µ–ª—å–Ω—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏",
      "module_naming": "–ù–∞–∑—ã–≤–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –º–æ–¥—É–ª–∏ –ø–æ —Å—Ö–µ–º–µ: <module>_test"
    },
    "available_formats": {
      "DAP_LOG_FORMAT_DEFAULT": "–ü–æ–ª–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —Å –≤—Ä–µ–º–µ–Ω–µ–º - –¥–ª—è production –ª–æ–≥–æ–≤",
      "DAP_LOG_FORMAT_SIMPLE": "–£–ø—Ä–æ—â–µ–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç - –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏",
      "DAP_LOG_FORMAT_NO_TIME": "–ë–µ–∑ –≤—Ä–µ–º–µ–Ω–∏ - –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω—ã—Ö –ª–æ–≥–æ–≤",
      "DAP_LOG_FORMAT_NO_PREFIX": "–ß–∏—Å—Ç—ã–π –≤—ã–≤–æ–¥ - –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –¥–ª—è unit —Ç–µ—Å—Ç–æ–≤"
    },
    "best_practices": [
      "–í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ NO_PREFIX —Ñ–æ—Ä–º–∞—Ç –≤ unit —Ç–µ—Å—Ç–∞—Ö",
      "–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π—Ç–µ —É—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏",
      "–í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —Ç–µ—Å—Ç–∞",
      "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ dap_log_set_simple_for_tests() –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏"
    ],
    "crypto_tests": "crypto/test/crypto/crypto-test",
    "core_tests": "core/test/",
    "benchmark_tests": "crypto/test/crypto/dap_enc_benchmark_test.c"
  },
  "context_management": {
    "structure": "Modular context system with on-demand loading",
    "local_tasks": ".local/ directory for current task isolation",
    "module_references": "References loaded only when needed",
    "update_policy": "Task-specific changes only affect .local files"
  },
  "current_task_data": {
    "source": ".local/context.json",
    "description": "Current task details and technical context"
  },
  "project_structure": {
    "source": "structure.json",
    "description": "Complete project structure with module references",
    "modules": "modules/*.json"
  },
  "auto_load_files": [
    "code_templates.json",
    "coding_guidelines.json", 
    "project_standards.json",
    "testing_guidelines.json"
  ],
  "technical_stack": {
    "languages": [
      "C",
      "CMake"
    ],
    "build_system": "CMake",
    "testing": "Enhanced custom test framework with advanced logging",
    "documentation": "Markdown",
    "platform": "Cross-platform (Linux, macOS, Windows)"
  },
  "cryptographic_focus": {
    "post_quantum": "Lattice-based cryptography",
    "security_level": "112-bit quantum resistance",
    "target_applications": [
      "Digital signatures",
      "Multi-signatures",
      "Aggregated signatures",
      "Batch verification",
      "Blockchain integration"
    ],
    "current_implementation": {
      "algorithm": "Chipmunk Post-Quantum Signature",
      "status": "‚úÖ PRODUCTION READY - 100% Complete",
      "completion_date": "2025-06-06",
      "key_achievements": [
        "‚úÖ Complete working implementation",
        "‚úÖ All tests passing",
        "‚úÖ Full DAP SDK integration",
        "‚úÖ Enhanced logging system",
        "‚úÖ Cross-platform compatibility",
        "‚úÖ Production-ready performance"
      ],
      "next_enhancements": [
        "üîÑ Integration into dap_sign module",
        "üîÑ Aggregated signature support",
        "üîÑ Batch verification optimization",
        "üîÑ Advanced multi-signature features"
      ]
    }
  },
  "infrastructure_enhancements": {
    "logging_system": {
      "status": "‚úÖ Enhanced",
      "new_features": [
        "Multiple logging formats (4 types)",
        "Unit test friendly NO_PREFIX format",
        "Performance optimized SIMPLE format",
        "Full backward compatibility"
      ],
      "api_functions": [
        "dap_log_set_format()",
        "dap_log_get_format()",
        "dap_log_set_simple_for_tests()"
      ],
      "levels": ["DEBUG", "INFO", "NOTICE", "WARNING", "ERROR", "CRITICAL"],
      "usage": "Use dap_log_it() for structured logging",
      "configuration": "Set via environment variables or config files"
    },
    "test_framework": {
      "status": "‚úÖ Enhanced",
      "improvements": [
        "macOS/Clang compatibility",
        "Fixed overflow builtin functions",
        "Enhanced logging integration",
        "Cleaner test output"
      ]
    }
  },
  "navigation_helpers": {
    "load_full_context": "./context/scripts/load_full_context.sh",
    "load_specific_module": "./context/scripts/load_module.sh <module_name>",
    "available_modules": ["crypto", "core", "net", "other"]
  },
  "debugging_methodology": {
    "segfault_analysis": {
      "tool": "lldb (macOS) or gdb (Linux)",
      "command": "lldb ./path/to/binary -o \"run\" -o \"bt\" -o \"quit\"",
      "description": "Get stack trace immediately when program crashes",
      "example": "lldb ./crypto/test/crypto/crypto-test -o \"run\" -o \"bt\" -o \"quit\"",
      "output_analysis": "Look for frame numbers, function names, and line numbers in stack trace"
    },
    "partial_output_capture": {
      "method": "Run program in background and kill after timeout",
      "command": "./program & PID=$!; sleep 3; kill $PID; wait $PID 2>/dev/null",
      "use_case": "When program hangs or crashes, capture output before crash"
    },
    "memory_debugging": {
      "asan_build": "Use build_asan/ for AddressSanitizer",
      "valgrind": "valgrind --tool=memcheck ./binary (Linux only)"
    }
  },
  "crypto_modules": {
    "chipmunk": {
      "status": "Production ready",
      "description": "Post-quantum signature algorithm",
      "location": "crypto/src/chipmunk/"
    },
    "kyber": {
      "status": "‚úÖ FIXED - union conflicts resolved",
      "description": "NIST Kyber KEM implementation", 
      "location": "crypto/src/Kyber/",
      "key_fixes": [
        "Fixed union conflicts in dap_enc_key_t structure",
        "Separated shared_key from pub_key_data storage",
        "Updated benchmark tests for KEM compatibility",
        "Fixed benchmark test logic for proper KEM protocol"
      ]
    },
    "msrln": {
      "status": "‚úÖ FIXED - benchmark test logic corrected",
      "description": "Microsoft Research lattice-based cryptography",
      "location": "crypto/src/msrln/",
      "key_fixes": [
        "Fixed s_transfer_test function for KEM compatibility",
        "Added proper ciphertext storage and cleanup",
        "Corrected gen_alice_shared_key parameter passing"
      ]
    },
    "multisign": {
      "status": "üîç NEXT TASK - Memory allocation error and NULL pointer dereference",
      "description": "Multi-signature algorithm implementation",
      "location": "crypto/src/dap_enc_multisign.c",
      "issue_details": {
        "crash_location": "dap_enc_multisign.c:394 in dap_enc_sig_multisign_verify_sign",
        "crash_type": "EXC_BAD_ACCESS (code=1, address=0x8) - NULL pointer in memmove",
        "root_cause": "Memory allocation errors in dap_enc_sig_multisign_forming_keys:112",
        "error_count": "5 consecutive 'Memory allocation error' messages",
        "stack_trace": "main ‚Üí dap_enc_benchmark_tests_run ‚Üí s_sign_verify_tests_run ‚Üí s_sign_verify_test_becnhmark ‚Üí s_sign_verify_test ‚Üí dap_enc_sig_multisign_verify_sign"
      },
      "debugging_approach": [
        "Investigate memory allocation failure in dap_enc_sig_multisign_forming_keys",
        "Check for proper memory cleanup and null pointer validation",
        "Verify multisign key generation and verification logic"
      ]
    }
  },
  "common_issues": {
    "sign_compare_warnings": {
      "solution": "Add explicit type casts: (unsigned int)expression",
      "compiler_flag": "-Werror=sign-compare",
      "locations": "core/test/dap_common_test.c - lines with dap_mul comparisons"
    },
    "union_conflicts": {
      "description": "dap_enc_key_t union fields overlap causing data corruption",
      "affected_fields": ["pub_key_data vs shared_key", "pub_key_data_size vs shared_key_size"],
      "solution": "Use appropriate field for algorithm type (KEM vs traditional encryption)"
    }
  },
  "logging_system": {
    "levels": ["DEBUG", "INFO", "NOTICE", "WARNING", "ERROR", "CRITICAL"],
    "usage": "Use dap_log_it() for structured logging",
    "configuration": "Set via environment variables or config files"
  }
}
